<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>POJ | klion26</title>
  <meta name="author" content="klion26">
  
  <meta name="description" content="个人博客，记录自己成长的点点滴滴">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="klion26"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/bootstrap.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">klion26</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/resume" title="Resume">
			  <i class=""></i>Resume
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 

<!-- title -->
<div class="page-header page-header-inverse ">
  <h1 class="archive-title-category title title-inverse ">POJ</h1>
</div>

<div class="row page">
  <!-- cols -->
  
  <div class="col-md-9">
	

	  <div id="top_search"></div>

      

      <div class="mypage">
	  
	    	
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-08-20 </div>
			<div class="article-title"><a href="/2011/08/20/reverse-poj-3761/" >[逆序]POJ_3761</a></div>						
		</h3>
	


	    	<div class="entry">
  <div class="row">
	
	
		<p><a href="http://poj.org/problem?id=3761" target="_blank" rel="external">想看题目?</a></p>
<p>题目大致意思就是:求1,2,3…..N有多少个排列是用冒泡排序只需要k轮就好的.给定一个n和一个k,然后让你输出答案模上一个数.因为答案是在太大了</p>
<p>这里首先给出公式吧对给定的n和k,答案是k!*((k+1)^(n-k)-k^(n-k)).</p>
<p>ps:以下分析借助了&lt;计算机程序设计艺术&gt;和<a href="http://hi.baidu.com/billdu/blog/item/a1fa28acd0a9ea1d4b36d60e.html" target="_blank" rel="external">这篇博文</a></p>
<p>首先我们知道对于每个排列和其逆序对是一一对应的.也就是说一个逆序对对应一个排列,一个排列对应一个逆序对,相同排列的逆序是一样的,同一个逆序对的排列也是一样的.下面我们来看看这个和逆序对有啥关系.这里以4 5 3 1 2这个排列为例.那么逆序对为3 3 2 0 0.也就是1的逆序数为3,2的为3,依次下去.那么我们来看下依次冒泡排序会改变什么,首先第一趟我们会发现变成了4 3 1 2 5.那么逆序对变成了2 2 1 0 0也就是所有逆序数&gt;0的都-1了,这个是偶然吗?不是的,因为对于每一趟冒泡,都有一个当前未排好序的最大的沉到最下面去,这样就会导致这个当前最大的数的后面的那些数的逆序数都会-1.上面的当前最大就是5,5后面的是3 1 2,所以3 1 2这几个数的逆序数都会-1.OK,现在我们知道,对于每趟冒泡排序,所有逆序数不为1的都会-1,那么体重要求的我们可以转化成求这样的排列的个数:也就是逆序数的最大值为k的n个数的一个排列.这样我们就得到了一个冒泡最多需要k次的一个排列,而且逆序数和排列是一一对应的,所以我们得到的”逆序数的最大值为k的n个数的排列”的个数就是本题的答案.</p>
<p>现在的问题变成了求逆序数的最大值为k的n个数的排列的个数,也就是给你n个位置,这n个位置上可以放置一系列数,但是最大为k,最小0的排列的数目,而且我们这里要求的是至少要有一个数=k(不然不需要k趟就排完了).那么我们可以考虑用最大的为k减去最大的为k-1的排列,剩下的就是至少有一个最大值为k的了.现在我们求最大值为k,但不一定有最大值为k的排列的数目.我们可以这么想:对于1,有逆序数为0,1…..k这些选择,也就是它的位置可以选择为0 1 2…k(位置从0开始),放置好1之后,我们再放2,同理可以得到一系列的位置,也就是2也可以有k+1中选择,知道某个数不可能出现逆序数为k为止,那么我们知道一个数的最大逆序数位n-i(i是这个数,这里的环境都是1,2….n这样的排列).那么最大的i就是k了.所以这里有(k+1)^(n-k),然后剩下的就自己选位置吧,有k!种方案,所以就是k!((k+1)^(n-k)).那么我们的结果就是k!<em>(k+1)^(n-k)-(k-1)!</em>k^(n-k+1)然后化简就变成了k!((k+1)^(n-k)-k^(n-k))到这里这题也结束了,不过还有一点,在保证不会越界的情况下,能不用mutil_mod(算a*b%c),这类的函数就不用,所有函数都是有开销的,别到时TLE了还找不到原因</p>

	
	</div>
</div>

	  
	    	
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-07-25 </div>
			<div class="article-title"><a href="/2011/07/25/half-plan-cross/" >[计算几何]半平面交 POJ_2451 1474 1279 3335</a></div>						
		</h3>
	


	    	<div class="entry">
  <div class="row">
	
	
		<p>半平面交,一开始以为很神奇的东西,看zzy的论文,看了好久,发现思路还好懂,不会写代码= =,只是觉得和melkman有点像.后来网上膜拜了各位牛人的代码,自己终于写出来了,A了2451,不过1474&amp;1279的时候发现了自己代码的错误,如果有多条直线平行那么我的代码会错,后来又在3335发现如果有反向平行且不共线的两条直线那么我的会错.于是各种改过之后,觉得现在的代码应该没啥问题了= =||</p>
<p>主要思路就是先对边进行排序[按极角序],然后去重,把平行同向的直线只保留规约最紧的一条.然后对留下来的进行半平面交.现在觉得单独的半平面交不难,难的是把题目转化为半平面交</p>
<p>2451代码如下[如有错误还请指出]</p>
<div class="dp-highlighter"><br><br>1.  <span><span class="comment">/<strong><strong> </strong></strong></span> </span><br>2.  <span><span class="comment"> 注意事项: </span> </span><br>3.  <span><span class="comment"> 1.单独的点是否是符合条件的 </span> </span><br>4.  <span><span class="comment"> 2.对于输入边有没有两条反向的 </span> </span><br>5.  <span><span class="comment"> </span> </span><br>6.  <span><span class="comment"> 对于1需要改变的是check里面判断时是&gt;还是&gt;= </span> </span><br>7.  <span><span class="comment"> 如果是&gt;那么会忽略掉点 否则会留下 </span> </span><br>8.  <span> </span><br>9.  <span><span class="comment"> 对于2的话需要特判一下是不是有两条边方向且不共线 </span> </span><br>10.  <span><span class="comment"> 这里需要在排序然后去重之后做 </span> </span><br>11.  <span><span class="comment"> /</span><span> </span></span><br>12.  <span>#include <stdio.h> </stdio.h></span><br>13.  <span>#include <string.h> </string.h></span><br>14.  <span>#include <stdlib.h> </stdlib.h></span><br>15.  <span>#include <math.h> </math.h></span><br>16.  <span>#include <algorithm> </algorithm></span><br>17.  <span> </span><br>18.  <span>using namespace std; </span><br>19.  <span class="comment">/<em>点的结构体</em>/</span><span> </span><br>20.  <span>typedef struct </span><br>21.  <span>{ </span><br>22.  <span> </span><span class="keyword">double</span><span> x,y; </span><br>23.  <span>}TPoint; </span><br>24.  <span class="comment">/<em>直线的结构体 angle是和X轴正方向的夹角</em>/</span><span> </span><br>25.  <span>typedef struct </span><br>26.  <span>{ </span><br>27.  <span> TPoint p1,p2; </span><br>28.  <span> </span><span class="keyword">double</span><span> angle; </span><br>29.  <span>}TLine; </span><br>30.  <span class="comment">/<em> a</em>x+b<em>y+c=0直线中的a b c</em>/</span><span> </span><br>31.  <span>typedef struct </span><br>32.  <span>{ </span><br>33.  <span> </span><span class="keyword">double</span><span> a,b,c; </span><br>34.  <span>}abcLine; </span><br>35.  <span> </span><br>36.  <span class="keyword">const</span><span> </span><span class="keyword">int</span><span> maxnum=</span><span class="number">20016</span><span> </span><br>37.  <span class="keyword">const</span><span> </span><span class="keyword">double</span><span> eps=1e-</span><span class="number">8</span><span> </span><br>38.  <span> </span><br>39.  <span class="keyword">int</span><span> n; </span><br>40.  <span class="comment">/<em>pg存半平面最后的点</em>/</span><span> </span><br>41.  <span>TPoint pg[maxnum]; </span><br>42.  <span class="comment">/<em>line存输入的边 dq是双端队列</em>/</span><span> </span><br>43.  <span>TLine line[maxnum],dq[maxnum+</span><span class="number">2</span><span>]; </span><br>44.  <span class="keyword">int</span><span> idx;</span><span class="comment">/<em>the index of pg;</em>/</span><span> </span><br>45.  <span> </span><br>46.  <span class="comment">/<em>加边 所有的边都表示的是<p1,p2>的左手边</p1,p2></em>/</span><span> </span><br>47.  <span class="keyword">void</span><span> Add_line(</span><span class="keyword">int</span><span> idx,</span><span class="keyword">double</span><span> x1,</span><span class="keyword">double</span><span> y1,</span><span class="keyword">double</span><span> x2,</span><span class="keyword">double</span><span> y2) </span><br>48.  <span>{ </span><br>49.  <span> line[idx].p1.x = x1; </span><br>50.  <span> line[idx].p1.y = y1; </span><br>51.  <span> line[idx].p2.x = x2; </span><br>52.  <span> line[idx].p2.y = y2; </span><br>53.  <span> line[idx].angle = atan2(y2-y1,x2-x1); </span><br>54.  <span>} </span><br>55.  <span class="comment">/<em>输入</em>/</span><span> </span><br>56.  <span class="keyword">void</span><span> input() </span><br>57.  <span>{ </span><br>58.  <span> </span><span class="keyword">int</span><span> i; </span><br>59.  <span> </span><span class="keyword">double</span><span> x1,y1,x2,y2; </span><br>60.  <span> </span><span class="keyword">for</span><span>(i=</span><span class="number">0</span><span>i<n;i++) <="" span=""><br>61.  <span> { </span><br>62.  <span> scanf(</span><span class="string">“%lf%lf%lf%lf”</span><span>,x1,&amp;y1,&amp;x2,&amp;y2); </span><br>63.  <span> Add_line(i,x1,y1,x2,y2); </span><br>64.  <span> } </span><br>65.  <span> </span><span class="comment">/<em>加外面的限制区域</em>/</span><span> </span><br>66.  <span> Add_line(n,</span><span class="number">0</span><span>,</span><span class="number">0</span><span>,</span><span class="number">10000</span><span>,</span><span class="number">0</span><span>); </span><br>67.  <span> Add_line(n+</span><span class="number">1</span><span>,</span><span class="number">10000</span><span>,</span><span class="number">0</span><span>,</span><span class="number">10000</span><span>,</span><span class="number">10000</span><span>); </span><br>68.  <span> Add_line(n+</span><span class="number">2</span><span>,</span><span class="number">10000</span><span>,</span><span class="number">10000</span><span>,</span><span class="number">0</span><span>,</span><span class="number">10000</span><span>); </span><br>69.  <span> Add_line(n+</span><span class="number">3</span><span>,</span><span class="number">0</span><span>,</span><span class="number">10000</span><span>,</span><span class="number">0</span><span>,</span><span class="number">0</span><span>); </span><br>70.  <span> n+=</span><span class="number">4</span><span> </span><br>71.  <span>} </span><br>72.  <span class="comment">/<em> </em></span><br>73.  <span><span class="comment"> 把一个double转化到一个int上 </span> </span><br>74.  <span><span class="comment"> &lt;-esp  的转化为-1 </span> </span><br>75.  <span><span class="comment"> &gt;eps   的转化为1 </span> </span><br>76.  <span><span class="comment"> 其他的为0 </span> </span><br>77.  <span><span class="comment"> /</span><span> </span></span><br>78.  <span class="keyword">int</span><span> dou2int(</span><span class="keyword">double</span><span> x) </span><br>79.  <span>{ </span><br>80.  <span> </span><span class="keyword">if</span><span>(x&gt;eps) </span><br>81.  <span> </span><span class="keyword">return</span><span> </span><span class="number">1</span><span> </span><br>82.  <span> </span><span class="keyword">if</span><span>(x&lt;-eps) </span><br>83.  <span> </span><span class="keyword">return</span><span> -</span><span class="number">1</span><span> </span><br>84.  <span> </span><span class="keyword">return</span><span> </span><span class="number">0</span><span> </span><br>85.  <span>} </span><br>86.  <span> </span><br>87.  <span class="comment">/<strong> </strong></span><br>88.  <span><span class="comment"> 计算<a,b>和&lt;a,c&gt;的叉积 </a,b></span> </span><br>89.  <span><span class="comment"> /</span><span> </span></span><br>90.  <span class="keyword">double</span><span> cross(TPoint a,TPoint b,TPoint c) </span><br>91.  <span>{ </span><br>92.  <span> </span><span class="keyword">return</span><span> (b.x-a.x)<em>(c.y-a.y)-(b.y-a.y)</em>(c.x-a.x); </span><br>93.  <span>} </span><br>94.  <span> </span><br>95.  <span class="comment">/<strong> </strong></span><br>96.  <span><span class="comment"> 多边形排序的模板函数 </span> </span><br>97.  <span><span class="comment"> 首先按照极角序排列,如果极角序一样的话 </span> </span><br>98.  <span><span class="comment"> 那么限制宽的排在前面 </span> </span><br>99.  <span><span class="comment"> /</span><span> </span></span><br>100.  <span>bool cmp(TLine l1,TLine l2) </span><br>101.  <span>{ </span><br>102.  <span> </span><span class="keyword">int</span><span> ret = dou2int(l1.angle-l2.angle); </span><br>103.  <span> </span><span class="keyword">if</span><span>(ret &gt; </span><span class="number">0</span><span>) </span><br>104.  <span> </span><span class="keyword">return</span><span> </span><span class="keyword">true</span><span> </span><br>105.  <span> </span><span class="keyword">if</span><span>(ret &lt; </span><span class="number">0</span><span>) </span><br>106.  <span> </span><span class="keyword">return</span><span> </span><span class="keyword">false</span><span> </span><br>107.  <span> </span><span class="keyword">if</span><span>(dou2int(cross(l2.p1,l2.p2,l1.p2))&gt;</span><span class="number">0</span><span>) </span><br>108.  <span> </span><span class="keyword">return</span><span> </span><span class="keyword">false</span><span> </span><br>109.  <span> </span><span class="keyword">return</span><span> </span><span class="keyword">true</span><span> </span><br>110.  <span>} </span><br>111.  <span> </span><br>112.  <span class="comment">/<strong> </strong></span><br>113.  <span><span class="comment"> 由直线上的两点得到a<em>x+b</em>y+c=0中的a b c </span> </span><br>114.  <span><span class="comment"> /</span><span> </span></span><br>115.  <span>abcLine Get_line(TPoint p1,TPoint p2) </span><br>116.  <span>{ </span><br>117.  <span> abcLine ret; </span><br>118.  <span> ret.a = p1.y-p2.y; </span><br>119.  <span> ret.b = p2.x-p1.x; </span><br>120.  <span> ret.c = p1.x<em>p2.y-p2.x</em>p1.y; </span><br>121.  <span> </span><span class="keyword">return</span><span> ret; </span><br>122.  <span>} </span><br>123.  <span class="comment">/<strong> </strong></span><br>124.  <span><span class="comment"> 得到TLine结构体定义的两条直线的交点 </span> </span><br>125.  <span><span class="comment"> /</span><span> </span></span><br>126.  <span>TPoint Get_jiao(TLine l1,TLine l2) </span><br>127.  <span>{ </span><br>128.  <span> TPoint ret; </span><br>129.  <span> abcLine A,B; </span><br>130.  <span> A = Get_line(l1.p1,l1.p2); </span><br>131.  <span> B = Get_line(l2.p1,l2.p2); </span><br>132.  <span> ret.x = (B.b<em>A.c-A.b</em>B.c)/(B.a<em>A.b-A.a</em>B.b); </span><br>133.  <span> ret.y = (A.a<em>B.c-B.a</em>A.c)/(B.a<em>A.b-A.a</em>B.b); </span><br>134.  <span> </span><span class="keyword">return</span><span> ret; </span><br>135.  <span>} </span><br>136.  <span class="comment">/<strong> </strong></span><br>137.  <span><span class="comment"> 半平面交的时候判断当前平面是否合法 </span> </span><br>138.  <span><span class="comment"> 是否需要退栈等 </span> </span><br>139.  <span><span class="comment"> 如果单独的点不符合条件的话那么if语句 </span> </span><br>140.  <span><span class="comment"> 的判断直接&gt;0就行了,否则写成&gt;=0 </span> </span><br>141.  <span><span class="comment"> /</span><span> </span></span><br>142.  <span>bool check(TLine l1,TLine l2,TLine l3) </span><br>143.  <span>{ </span><br>144.  <span> TPoint cro = Get_jiao(l1,l2); </span><br>145.  <span> </span><span class="keyword">if</span><span>(dou2int(cross(l3.p1,l3.p2,cro))&gt;</span><span class="number">0</span><span>)</span><span class="comment">//加上等于0那么后来的直线过交点的时候不会退出 </span><span> </span><br>146.  <span> </span><span class="keyword">return</span><span> </span><span class="keyword">false</span><span> </span><br>147.  <span> </span><span class="keyword">return</span><span> </span><span class="keyword">true</span><span> </span><br>148.  <span>} </span><br>149.  <span class="comment">/<strong> </strong></span><br>150.  <span><span class="comment"> 判断两条直线是否平行反向且不共线 </span> </span><br>151.  <span><span class="comment"> 下面的代码中需要加上不共线 需要对出去之后的直线进行判断 </span> </span><br>152.  <span><span class="comment"> /</span><span> </span></span><br>153.  <span>bool overline(TLine l1,TLine l2) </span><br>154.  <span>{ </span><br>155.  <span> </span><span class="keyword">int</span><span> ret; </span><br>156.  <span> </span><span class="keyword">int</span><span> a,b,c,d; </span><br>157.  <span> a = (l1.p1.y-l1.p2.y)<em>(l2.p1.x-l2.p2.x); </em></span><br>158.  <span> b = (l1.p1.x-l1.p2.x)(l2.p1.y-l2.p2.y); </span><br>159.  <span> c = l1.p1.x-l1.p2.x; </span><br>160.  <span> d = l2.p1.x-l2.p2.x; </span><br>161.  <span> ret = dou2int(cross(l1.p1,l1.p2,l2.p1)); </span><br>162.  <span> </span><span class="keyword">if</span><span>((a==b) &amp; (c<em>d&lt;</em></span><span class="number">0</span><span>) &amp;&amp; (</span><span class="number">0</span><span> != ret)) </span><br>163.  <span> { </span><br>164.  <span> </span><span class="comment">//printf(“%f  %f   %f   %f\n”,l1.p1.x,l1.p1.y,l1.p2.x,l1.p2.y); </span><span> </span><br>165.  <span> </span><span class="comment">//printf(“%f  %f   %f   %f\n”,l2.p1.x,l2.p1.y,l2.p2.x,l2.p2.y); </span><span> </span><br>166.  <span> </span><span class="keyword">return</span><span> </span><span class="keyword">true</span><span> </span><br>167.  <span> } </span><br>168.  <span> </span><span class="keyword">return</span><span> </span><span class="keyword">false</span><span> </span><br>169.  <span>} </span><br>170.  <span> </span><br>171.  <span class="comment">/ </span><br>172.  <span><span class="comment"> work 求半平面交 最后的顶点存在pg数组里面 </span> </span><br>173.  <span><span class="comment"> 用到上面的TPoint TLine abcLine结构体 </span> </span><br>174.  <span><span class="comment"> 会用到上面的 </span> </span><br>175.  <span><span class="comment"> check    :判断当前测试的直线是否在一直区域的范围内 </span> </span><br>176.  <span><span class="comment"> dou2int  :double转int  &lt;-eps对应-1 &gt;eps 对应1 否则为0 </span> </span><br>177.  <span><span class="comment"> cross    :算叉积 </span> </span><br>178.  <span><span class="comment"> Get_jiao :由两条直线得到交点 </span> </span><br>179.  <span><span class="comment"> Get_line :由直线上的两个点得到直线的一般式 </span> </span><br>180.  <span><span class="comment"> cmp等函数:sort用的比较函数,首先是旋转角,如果旋转角 </span> </span><br>181.  <span><span class="comment"> 一样的话,那么要求松的放到前面,这样后面好写点 </span> </span><br>182.  <span><span class="comment"> <em>/</em></span><span> </span></span><br>183.  <span class="keyword">void</span><span> work() </span><br>184.  <span>{ </span><br>185.  <span> sort(line,line+n,cmp); </span><br>186.  <span> </span><span class="comment">/首先对所有直线进行排序<em>/</em></span><span> </span><br>187.  <span> </span><span class="comment">/<strong> </strong></span><br>188.  <span><span class="comment"> 把平行且限制宽的直线去掉 </span> </span><br>189.  <span><span class="comment"> /</span><span> </span></span><br>190.  <span> </span><span class="keyword">for</span><span>(</span><span class="keyword">int</span><span> i=</span><span class="number">1</span><span>i<n;i++) <="" span=""><br>191.  <span> { </span><br>192.  <span> </span><span class="keyword">if</span><span>(dou2int(line[i].angle-line[i-</span><span class="number">1</span><span>].angle)==</span><span class="number">0</span><span>) </span><br>193.  <span> { </span><br>194.  <span> memmove(line+i-</span><span class="number">1</span><span>,line+i,(n-i)sizeof(line[</span><span class="number">0</span><span>])); </span><br>195.  <span> n–; </span><br>196.  <span> i–;</span><span class="comment">/<em>防止多条直线平行</em>/</span><span> </span><br>197.  <span> } </span><br>198.  <span> } </span><br>199.  <span> </span><span class="comment">/<em>上面的for循环对直线进行”去重”</em>/</span><span> </span><br>200.  <span> </span><span class="keyword">int</span><span> top,bot; </span><br>201.  <span> bot = </span><span class="number">1</span><span> </span><br>202.  <span> top=</span><span class="number">2</span><span> </span><br>203.  <span> dq[bot]=line[</span><span class="number">0</span><span>]; </span><br>204.  <span> dq[top]=line[</span><span class="number">1</span><span>]; </span><br>205.  <span> </span><br>206.  <span> </span><span class="comment">/<strong> </strong></span><br>207.  <span><span class="comment"> 半平面交核心算法 </span> </span><br>208.  <span><span class="comment"> 和melkman算法有点像,每次考虑当前直线 </span> </span><br>209.  <span><span class="comment"> 然后把这条直线加入到双端队列中 </span> </span><br>210.  <span><span class="comment"> /</span><span> </span></span><br>211.  <span> </span><span class="keyword">for</span><span>(</span><span class="keyword">int</span><span> i=</span><span class="number">2</span><span>i<n;i++) <="" span=""><br>212.  <span> { </span><br>213.  <span> </span><span class="keyword">while</span><span>(top&gt;bot &amp; check(dq[top-</span><span class="number">1</span><span>],dq[top],line[i])) </span><br>214.  <span> top–; </span><br>215.  <span> </span><span class="keyword">while</span><span>(top&gt;bot &amp; check(dq[bot+</span><span class="number">1</span><span>],dq[bot],line[i])) </span><br>216.  <span> bot++; </span><br>217.  <span> </span><br>218.  <span> dq[++top]=line[i]; </span><br>219.  <span> </span><br>220.  <span> } </span><br>221.  <span> </span><br>222.  <span> </span><span class="keyword">while</span><span>(top&gt;bot &amp; check(dq[top-</span><span class="number">1</span><span>],dq[top],dq[bot])) </span><br>223.  <span> top–; </span><br>224.  <span> </span><span class="keyword">while</span><span>(top&gt;bot &amp; check(dq[bot+</span><span class="number">1</span><span>],dq[bot],dq[top])) </span><br>225.  <span> bot++; </span><br>226.  <span> dq[–bot]=dq[top];</span><span class="comment">/<em>把最后一条直线加到最前面 这样方便计算</em>/</span><span> </span><br>227.  <span> </span><br>228.  <span> </span><span class="comment">/<strong> </strong></span><br>229.  <span><span class="comment"> 输出由题目决定 这里表示无闭合区域 </span> </span><br>230.  <span><span class="comment"> /</span><span> </span></span><br>231.  <span> </span><span class="keyword">if</span><span>(top-bot&lt;</span><span class="number">3</span><span>) </span><br>232.  <span> {</span><span class="comment">/<em>因为上面加了一条直线 所以这里是3</em>/</span><span> </span><br>233.  <span> printf(</span><span class="string">“0.0\n”</span><span>); </span><br>234.  <span> </span><span class="keyword">return</span><span> ; </span><br>235.  <span> } </span><br>236.  <span> idx=</span><span class="number">0</span><span> </span><br>237.  <span> </span><span class="keyword">for</span><span>(</span><span class="keyword">int</span><span> i=bot;i<top;i++) <="" span=""><br>238.  <span> pg[idx++] = Get_jiao(dq[i],dq[i+</span><span class="number">1</span><span>]); </span><br>239.  <span> idx–; </span><br>240.  <span> </span><span class="comment">/<em>下面用叉积算面积</em>/</span><span> </span><br>241.  <span> </span><span class="keyword">double</span><span> ans=pg[idx].x<em>pg[</em></span><span class="number">0</span><span>].y-pg[</span><span class="number">0</span><span>].xpg[idx].y; </span><br>242.  <span> </span><span class="keyword">for</span><span>(</span><span class="keyword">int</span><span> i=</span><span class="number">0</span><span>i<idx;i++) <="" span=""><br>243.  <span> ans += pg[i].x<em>pg[i+</em></span><span class="number">1</span><span>].y-pg[i+</span><span class="number">1</span><span>].xpg[i].y; </span><br>244.  <span> ans /= </span><span class="number">2.0</span><span> </span><br>245.  <span> </span><span class="keyword">if</span><span>(ans &lt; </span><span class="number">0</span><span>)</span><span class="comment">/<em>如果是负的话转为正的</em>/</span><span> </span><br>246.  <span> ans = -ans; </span><br>247.  <span> </span><span class="comment">/<em> </em></span><br>248.  <span><span class="comment"> 这里ans = -ans要注意别把0转化为-0了 </span> </span><br>249.  <span><span class="comment"> 比如写成ans=ans&gt;0?ans:-ans;的话会把0变成-0; </span> </span><br>250.  <span><span class="comment"> /</span><span> </span></span><br>251.  <span> printf(</span><span class="string">“%.1f\n”</span><span>,ans); </span><br>252.  <span>} </span><br>253.  <span> </span><br>254.  <span class="keyword">int</span><span> main(</span><span class="keyword">void</span><span>) </span><br>255.  <span>{ </span><br>256.  <span> #ifndef ONLINE_JUDGE </span><br>257.  <span> freopen(</span><span class="string">“2451.in”</span><span>,</span><span class="string">“r”</span><span>,stdin); </span><br>258.  <span> freopen(</span><span class="string">“2451.out”</span><span>,</span><span class="string">“w”</span><span>,stdout); </span><br>259.  <span> #endif </span><br>260.  <span> scanf(</span><span class="string">“%d”</span><span>,n); </span><br>261.  <span> input(); </span><br>262.  <span> work(); </span><br>263.  <span> </span><span class="keyword">return</span><span> </span><span class="number">0</span><span> </span><br>264.  <span>} </span><br></idx;i++)></span></top;i++)></span></n;i++)></span></n;i++)></span></n;i++)></span></div>

	
	</div>
</div>

	  
	    	
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-05-12 </div>
			<div class="article-title"><a href="/2011/05/12/number-theory-poj-3358/" >[数论]POJ 3358</a></div>						
		</h3>
	


	    	<div class="entry">
  <div class="row">
	
	
		<p><a href="http://poj.org/problem?id=3358" target="_blank" rel="external">传送门</a><br>这题首先你要知道化成二进制的小数可以每次分子<em>2,再对分母求余,然后分母不变,这样就能得到所有的二进制小数了.知道了这一点之后,剩下的就只是一个欧拉函数的问题了.<br>题中给出p/q.需要求出r和s,那么按照上面的思想,可以转化成p</em>2^(r+s)=p<em>2^r(mod q)继续化变成<br>q|p</em>2^r(2^s-1).到了这里我们就基本没啥问题了,首先可以把p和q都除掉gcd(p,q)使之变成p’,q’.那么就变成了q’|p’<em>2^r(2^s-1)—–&gt;q’|2^r(2^s-1)(I)[因为没有p’和q’公因子了可以直接忽略p’],这里我们再把q’和2^r的最大公约数除掉,也就是q’一直除2知道不能除尽位置,这里就可以算法r了.算出r之后上面的式子I就再次变成了q’|(2^s-1)这里就熟悉了,我们转化成2^s=1(mod q’),首先我们知道gcd(2,q’)=1,然后2^phi(q’)=1(mod q’),对于k|q’,2^k=1(mod q’)也是有可能的,这里可以参照原根,因为如果对于2^k=1(mod q’)中最小的k==phi(q’)那么2就是q’的一个原根.好了,到这里本题基本就结束了.只需要求出q’的欧拉函数,然后对phi(q’)的每个因子都去试验下p</em>2^(r+k)  ?= p*2^r(mod q)如果等式成立,那么k就是答案(这里的k是phi(q’)的最小约数)代码如下:</p>
<div class="dp-highlighter"><br><br>1.  <span><span class="preprocessor">#include <stdio.h> </stdio.h></span><span>  </span></span><br>2.  <span> </span><span class="preprocessor">#include <string.h> </string.h></span><span>  </span><br>3.  <span class="preprocessor">#include <stdlib.h> </stdlib.h></span><span>  </span><br>4.  <span class="preprocessor">#include <math.h> </math.h></span><span>  </span><br>5.  <span class="datatypes"><strong>int64</strong></span><span> p,q,s,pr,r;   </span><br>6.  <span class="datatypes">int64</span><span> prime[6760],idx;   </span><br>7.  <span class="datatypes"><strong>int64</strong></span><span> my_map[36][2],total;   </span><br>8.  <span class="comment">/<em>初始化素数 用来分解一个数</em>/</span><span>  </span><br>9.  <span class="keyword">void</span><span> init_prime()   </span><br>10.  <span>{   </span><br>11.  <span>    </span><span class="datatypes">int64</span><span> i,j;   </span><br>12.  <span>    </span><span class="datatypes">char</span><span> p[65536];   </span><br>13.  <span>    memset(p,0,</span><span class="keyword">sizeof</span><span>(p));   </span><br>14.  <span>    prime[0]=2;   </span><br>15.  <span>    idx = 1;   </span><br>16.  <span>    </span><span class="keyword">for</span><span>(i=4;i<65536;i+=2) <="" span=""><br>17.  <span>        {   </span><br>18.  <span>            p[i]=1;   </span><br>19.  <span>        }   </span><br>20.  <span>    </span><span class="keyword">for</span><span>(i=3;i<65536;i +="2)" <="" span=""><br>21.  <span>        {   </span><br>22.  <span>            </span><span class="keyword">if</span><span>(0 == p[i])   </span><br>23.  <span>                {   </span><br>24.  <span>                    prime[idx]=i;   </span><br>25.  <span>                    idx++;   </span><br>26.  <span>                    </span><span class="keyword">for</span><span>(j = i<em>i;j &lt;65536; j += 2</em>i)   </span><br>27.  <span>                        {   </span><br>28.  <span>                            p[j]=1;   </span><br>29.  <span>                        }   </span><br>30.  <span>                }   </span><br>31.  <span>        }   </span><br>32.  <span>}   </span><br>33.  <span class="comment">/<em>两个数的最大公约数</em>/</span><span>  </span><br>34.  <span class="datatypes"><strong>int64</strong></span><span> gcd(</span><span class="datatypes">int64</span><span> a,</span><span class="datatypes"><strong>int64</strong></span><span> b)   </span><br>35.  <span>{   </span><br>36.  <span>    </span><span class="datatypes">int64</span><span> t;   </span><br>37.  <span>    </span><span class="keyword">while</span><span>(b)   </span><br>38.  <span>        {   </span><br>39.  <span>            t = a;   </span><br>40.  <span>            a = b;   </span><br>41.  <span>            b = t%b;   </span><br>42.  <span>        }   </span><br>43.  <span>    </span><span class="keyword">return</span><span> a;   </span><br>44.  <span>}   </span><br>45.  <span class="comment">/<em>求n的欧拉函数</em>/</span><span>  </span><br>46.  <span class="datatypes"><strong>int64</strong></span><span> get_phi(</span><span class="datatypes">int64</span><span> n)   </span><br>47.  <span>{   </span><br>48.  <span>    </span><span class="datatypes"><strong>int64</strong></span><span> ret=1;   </span><br>49.  <span>    </span><span class="datatypes">int64</span><span> i;   </span><br>50.  <span>    </span><span class="keyword">for</span><span>(i=2;i<em>i&lt;=n;i++)   </em></span><br>51.  <span>        {   </span><br>52.  <span>            </span><span class="keyword">if</span><span>(0 == (n%i))   </span><br>53.  <span>                {   </span><br>54.  <span>                    n /= i;   </span><br>55.  <span>                    ret = i-1;   </span><br>56.  <span>                    </span><span class="keyword">while</span><span>(0 == (n%i))   </span><br>57.  <span>                        {   </span><br>58.  <span>                            n /= i;   </span><br>59.  <span>                            ret <em>= i;   </em></span><br>60.  <span>                        }   </span><br>61.  <span>                }   </span><br>62.  <span>        }   </span><br>63.  <span>    </span><span class="keyword">if</span><span>(n &gt; 1)   </span><br>64.  <span>        ret = (n-1);   </span><br>65.  <span>    </span><span class="keyword">return</span><span> ret;   </span><br>66.  <span>}   </span><br>67.  <span class="comment">/<em>快速幂取模</em>/</span><span>  </span><br>68.  <span class="datatypes"><strong>int64</strong></span><span> pow_mod(</span><span class="datatypes">int64</span><span> a,</span><span class="datatypes"><strong>int64</strong></span><span> b,</span><span class="datatypes">int64</span><span> c)   </span><br>69.  <span>{   </span><br>70.  <span>    </span><span class="datatypes"><strong>int64</strong></span><span> ret=1;   </span><br>71.  <span>    </span><span class="keyword">while</span><span>(b)   </span><br>72.  <span>        {   </span><br>73.  <span>            </span><span class="keyword">if</span><span>(b1)   </span><br>74.  <span>                ret = (ret<em>a)%c;   </em></span><br>75.  <span>            b &gt;&gt;= 1;   </span><br>76.  <span>            a = (aa)%c;   </span><br>77.  <span>        }   </span><br>78.  <span>    </span><span class="keyword">return</span><span> ret;   </span><br>79.  <span>}   </span><br>80.  <span class="comment">/<em>dfs枚举q’的所有因子</em>/</span><span>  </span><br>81.  <span class="keyword">void</span><span> dfs(</span><span class="datatypes">int64</span><span> val,</span><span class="datatypes"><strong>int64</strong></span><span> now)   </span><br>82.  <span>{   </span><br>83.  <span>    </span><span class="datatypes">int64</span><span> t,j;   </span><br>84.  <span>    </span><span class="keyword">if</span><span>(now == total)   </span><br>85.  <span>        {   </span><br>86.  <span>            t = pow_mod(2,r+val,q);   </span><br>87.  <span>            </span><span class="keyword">if</span><span>((p<em>t)%q == pr)   </em></span><br>88.  <span>                {   </span><br>89.  <span>                    </span><span class="keyword">if</span><span>(val &lt; s)   </span><br>90.  <span>                        s = val;   </span><br>91.  <span>                }   </span><br>92.  <span>            </span><span class="keyword">return</span><span> ;   </span><br>93.  <span>        }   </span><br>94.  <span>    j = 1;   </span><br>95.  <span>    </span><span class="keyword">for</span><span>(t = 0;t&lt;=my_map[now][1];t++)   </span><br>96.  <span>        {   </span><br>97.  <span>            dfs(valj,now+1);   </span><br>98.  <span>            j = j<em>my_map[now][0];   </em></span><br>99.  <span>        }   </span><br>100.  <span>}   </span><br>101.  <span class="comment">/算法主体<em>/</em></span><span>  </span><br>102.  <span class="keyword">void</span><span> work()   </span><br>103.  <span>{   </span><br>104.  <span>    </span><span class="datatypes"><strong>int64</strong></span><span> p1,q1,tq;   </span><br>105.  <span>    </span><span class="datatypes">int64</span><span> e,i;   </span><br>106.  <span>    tq = gcd(p,q);   </span><br>107.  <span>    p1 = p/tq;   </span><br>108.  <span>    q1 = q/tq;   </span><br>109.  <span>    tq = q;   </span><br>110.  <span>    r = 1;   </span><br>111.  <span>    </span><span class="comment">/求r的值<em>/</em></span><span>  </span><br>112.  <span>    </span><span class="keyword">while</span><span>(0 == (tq1))   </span><br>113.  <span>        {   </span><br>114.  <span>            r++;   </span><br>115.  <span>            tq &gt;&gt;= 1;   </span><br>116.  <span>        }   </span><br>117.  <span>  </span><br>118.  <span>    e = get_phi(tq);   </span><br>119.  <span>    total = 0;   </span><br>120.  <span>    s = e;   </span><br>121.  <span>    </span><span class="comment">/分解phi(tq)<em>/</em></span><span>  </span><br>122.  <span>    </span><span class="keyword">for</span><span>(i=0;i<idx;i++) <="" span=""><br>123.  <span>        {   </span><br>124.  <span>            </span><span class="keyword">if</span><span>(0 == (e%prime[i]))   </span><br>125.  <span>                {   </span><br>126.  <span>                    my_map[total][0] = prime[i];   </span><br>127.  <span>                    my_map[total][1] = 0;   </span><br>128.  <span>                    </span><span class="keyword">while</span><span>(0 == (e%prime[i]))   </span><br>129.  <span>                        {   </span><br>130.  <span>                            e /= prime[i];   </span><br>131.  <span>                            my_map[total][1]++;   </span><br>132.  <span>                        }   </span><br>133.  <span>                    total++;   </span><br>134.  <span>                }   </span><br>135.  <span>        }   </span><br>136.  <span>    pr = (ppow_mod(2,r,q))%q;   </span><br>137.  <span>    dfs(1,0);   </span><br>138.  <span>    printf(</span><span class="string">“%I64d,%I64d\n”</span><span>,r,s);   </span><br>139.  <span>}   </span><br>140.  <span>  </span><br>141.  <span class="datatypes">int</span><span> main(</span><span class="keyword">void</span><span>)   </span><br>142.  <span>{   </span><br>143.  <span>    </span><span class="datatypes">int</span><span> i=1;   </span><br>144.  <span>    init_prime();   </span><br>145.  <span>    </span><span class="keyword">while</span><span>(EOF != scanf(</span><span class="string">“%I64d/%I64d”</span><span>,p,&amp;q))   </span><br>146.  <span>        {   </span><br>147.  <span>          </span><span class="comment">//printf(“%I64d\n”,(p*pow_mod(2,8,q))%q); </span><span>  </span><br>148.  <span>            printf(</span><span class="string">“Case #%d: “</span><span>,i);   </span><br>149.  <span>            i++;   </span><br>150.  <span>            work();   </span><br>151.  <span>        }   </span><br>152.  <span>    </span><span class="keyword">return</span><span> 0;   </span><br>153.  <span>}   </span><br></idx;i++)></span></65536;i></span></65536;i+=2)></span></div>

	
	</div>
</div>

	  
	    	
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-04-30 </div>
			<div class="article-title"><a href="/2011/04/30/primitive-root-poj-1284/" >原根的个数 POJ_1284</a></div>						
		</h3>
	


	    	<div class="entry">
  <div class="row">
	
	
		<div>首先e[m,a]表示使得a^e[m,a]=1(mod m)的最小的正整数.那么我们有e[m,a^k]=e[m,a]/gcd(e[m,a],k)(k&gt;0).证明如下:记x=e[m,a],x’=x/gcd(x,k);x’’=e[m,a^k];先证明x’|x’’.</div><br><div>由题意可知a^x=1(mod m)  (a^k)^x’’=1(mod m)</div><br><div>由性质又因为e[m,a]|k<em>x’’,所以 x’=(x/gcd(x,k)) | (k</em>x’’/(gcd(x,k)).又gcd(x/gcd(x,k),k/gcd(x,k))=1.所以x’|x’’.</div><br><div>再证明x’’|x’      </div><br><div>a^(k<em>x’)=(a^k)^x’=1(mod m)—&gt;x’’|x’</em></div><br><div>所以x’=x’’;</div><br><div>推论如果gcd(k,e[m,a])=1,e[m,a^k]=e[m,a];我们可以用这个来求原根的个数.假设一个数n存在原根,且最小的原根等于g.n的欧拉函数为phi[n].那么n的原根的个数就是phi[phi[n]].也就是g的t次方[gcd(t,phi[n])=1 1&lt;=t&lt;phi[n])也是一个原根,当然这里也包含了所有的原根[想想为什么?似乎只能说明原根数至少是phi[phi[n]]个?再好好想想就出来了.注意a^k != 1(mod m)(k&lt;e[m,a])]</div><br><div>那么1284就直接求一个数的欧拉函数了.代码如下:</div><br><div class="dp-highlighter"><br><br>1.  <span><span class="comment">/ </span> </span><br>2.  <span><span class="comment">ID:klion26 </span> </span><br>3.  <span><span class="comment">LANG:C </span> </span><br>4.  <span><span class="comment">TASK:POJ_1284 </span> </span><br>5.  <span><span class="comment"> <em>/</em></span><span>  </span></span><br>6.  <span> </span><span class="preprocessor">#include <stdio.h> </stdio.h></span><span>  </span><br>7.  <span class="preprocessor">#include <string.h> </string.h></span><span>  </span><br>8.  <span class="preprocessor">#include <stdlib.h> </stdlib.h></span><span>  </span><br>9.  <span class="preprocessor">#include <math.h> </math.h></span><span>  </span><br>10.  <span>  </span><br>11.  <span class="datatypes">int</span><span> eular[65540];   </span><br>12.  <span class="keyword">void</span><span> init()   </span><br>13.  <span>{   </span><br>14.  <span>    </span><span class="datatypes">int</span><span> i,j;   </span><br>15.  <span>    memset(eular,0,</span><span class="keyword">sizeof</span><span>(eular));   </span><br>16.  <span>    </span><span class="keyword">for</span><span>(i=2;i<65536;i++) <="" span=""><br>17.  <span>        {   </span><br>18.  <span>            </span><span class="keyword">if</span><span>(0 == eular[i])   </span><br>19.  <span>                {   </span><br>20.  <span>                    </span><span class="keyword">for</span><span>(j=i;j<65536;j+=i) <="" span=""><br>21.  <span>                        {   </span><br>22.  <span>                            </span><span class="keyword">if</span><span>(0 == eular[j])   </span><br>23.  <span>                                eular[j]=j;   </span><br>24.  <span>                            eular[j] /= i;   </span><br>25.  <span>                            eular[j] = (i-1);   </span><br>26.  <span>                        }   </span><br>27.  <span>                }   </span><br>28.  <span>        }   </span><br>29.  <span>}   </span><br>30.  <span class="datatypes">int</span><span> main(</span><span class="keyword">void</span><span>)   </span><br>31.  <span>{   </span><br>32.  <span>    </span><span class="datatypes">int</span><span> p;   </span><br>33.  <span>    init();   </span><br>34.  <span>    </span><span class="keyword">while</span><span>(EOF != scanf(</span><span class="string">“%d”</span><span>,p))   </span><br>35.  <span>        {   </span><br>36.  <span>            printf(</span><span class="string">“%d\n”</span><span>,eular[eular[p]]);   </span><br>37.  <span>        }   </span><br>38.  <span>    </span><span class="keyword">return</span><span> 0;   </span><br>39.  <span>}   </span><br></65536;j+=i)></span></65536;i++)></span></div>

	
	</div>
</div>

	  
	    	
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-04-11 </div>
			<div class="article-title"><a href="/2011/04/11/drab-queue-poj-2823/" >POJ 2823 单调队列+IO优化</a></div>						
		</h3>
	


	    	<div class="entry">
  <div class="row">
	
	
		<p><a href="http://poj.org/problem?id=2823" target="_blank" rel="external">传送门</a><br>在网上逛的时候,看到一个博主说里下单调队列,然后说这题是单调队列的直接应用.就做了下,发现单调队列其实也很容易嘛.不过这题在WS的POJ上需要加上IO优化,不然就一直TLE.或许是我的程序写措了.不可能吧^-^<br>具体的单调队列介绍还是请看<a href="http://www.felix021.com/blog/read.php?1965" target="_blank" rel="external">这位博主</a>的.单调队列保证队列的首元素是最优的,如果队首元素”已过期”就”出队”,在考虑新元素时,弹出队列中每当前这个元素优的所有元素,然后这个元素入队.一直这样操作,就能保证队首元素一直是最优的.下面给出IO优化的两个函数:</p>
<div style="background: none repeat scroll 0% 0% #fdfdfd; color: black;">: <a href="http://fayaa.com/code/view/18471/" target="_blank" rel="external"></a></div><br><div class="source" style="font-family: amp;amp; color: #f5deb3; background-color: #2f4f4f;"><br><br><span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #ffffff;">get_int</span>()<br><br><span style="color: #f5deb3;">{</span><br><br><span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #f5deb3;">ret</span><span style="color: #f5deb3;">=</span><span style="color: #add8e6;">0</span><br><br><span style="color: #98fb98; font-weight: bold;">char</span> <span style="color: #f5deb3;">c</span><br><br><span style="color: #98fb98; font-weight: bold;">char</span> <span style="color: #f5deb3;">flag</span><span style="color: #f5deb3;">=</span><span style="color: #add8e6;">0</span><br><br><span style="color: #f5deb3;">c</span><span style="color: #f5deb3;">=</span><span style="color: #f5deb3;">getchar</span>();<br><br><span style="color: #b0c4de; font-weight: bold;">while</span>(<span style="color: #7fffd4;">‘ ‘</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">c</span> || <span style="color: #7fffd4;">‘\n’</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">c</span>)<br><br><span style="color: #f5deb3;">c</span><span style="color: #f5deb3;">=</span><span style="color: #f5deb3;">getchar</span>();<br><br><span style="color: #b0c4de; font-weight: bold;">if</span>(<span style="color: #7fffd4;">‘-‘</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">c</span>)<br><br><span style="color: #f5deb3;">{</span><br><br><span style="color: #f5deb3;">flag</span><span style="color: #f5deb3;">=</span><span style="color: #add8e6;">1</span><br><br><span style="color: #f5deb3;">c</span><span style="color: #f5deb3;">=</span><span style="color: #f5deb3;">getchar</span>();<br><br><span style="color: #f5deb3;">}</span><br><br><span style="color: #b0c4de; font-weight: bold;">while</span>(<span style="color: #f5deb3;">isdigit</span>(<span style="color: #f5deb3;">c</span>))<br><br><span style="color: #f5deb3;">{</span><br><br><span style="color: #f5deb3;">ret</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">ret</span><span style="color: #f5deb3;">*</span><span style="color: #add8e6;">10</span><span style="color: #f5deb3;">+</span><span style="color: #f5deb3;">c</span><span style="color: #f5deb3;">-</span><span style="color: #7fffd4;">‘0’</span><br><br><span style="color: #f5deb3;">c</span><span style="color: #f5deb3;">=</span><span style="color: #f5deb3;">getchar</span>();<br><br><span style="color: #f5deb3;">}</span><br><br><span style="color: #b0c4de; font-weight: bold;">if</span>(<span style="color: #add8e6;">1</span><span style="color: #f5deb3;">==</span><span style="color: #f5deb3;">flag</span>)<br><br><span style="color: #f5deb3;">ret</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">-</span><span style="color: #f5deb3;">ret</span><br><br><span style="color: #b0c4de; font-weight: bold;">return</span> <span style="color: #f5deb3;">ret</span><br><br><span style="color: #f5deb3;">}</span><br><br><span style="color: #98fb98; font-weight: bold;">void</span> <span style="color: #ffffff;">put_char</span>(<span style="color: #98fb98; font-weight: bold;">int</span> n)<br><br><span style="color: #f5deb3;">{</span><br><br><span style="color: #b0c4de; font-weight: bold;">if</span>(n<span style="color: #f5deb3;">&gt;=</span><span style="color: #add8e6;">10</span>)<br><br><span style="color: #f5deb3;">put_char</span>(n<span style="color: #f5deb3;">/</span><span style="color: #add8e6;">10</span>);<br><br><span style="color: #f5deb3;">putchar</span>(n<span style="color: #f5deb3;">%</span><span style="color: #add8e6;">10</span> <span style="color: #f5deb3;">+</span> <span style="color: #7fffd4;">‘0’</span>);<br><br><span style="color: #f5deb3;">}</span><br><br></div>

	
	</div>
</div>

	  
	    	
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-03-17 </div>
			<div class="article-title"><a href="/2011/03/17/poj-1704-game/" >POJ 1704 博弈</a></div>						
		</h3>
	


	    	<div class="entry">
  <div class="row">
	
	
		<p><a href="http://poj.org/problem?id=1704" target="_blank" rel="external">传送门</a></p>
<p>这题看懂了就是一个staircase nim,没看懂就比较难做了.对于staircase nim的理解,你可以这样想.把每两个chess的距离算出来,那么移动任何一个chess的话,会同时改变和这个chess相关的两个距离,左边的减少,右边的增加,这样你就可以把右边的看成是低的梯子,左边是高的梯子.然后用staircase nim来解决就OK了,staircase nim只与奇数层的梯子上的石子数有关,这个可以用P-positon和N-position的定义归纳来证明[每一个P-position只能到达N-position和每个N-position都能达到至少一个P-position].具体关系就是把所有的奇数层上的石子单独拿出来,做一般的nim游戏,如果某个点使P-position的话,那么还原之后的这个staircase nim也处于一个P-position的状态上.反之亦然.<br>代码如下:</p>
<div class="source" style="background-color: #2f4f4f; font-family: 'Courier New','Consolas','Lucida Console'; color: #f5deb3;"><span style="color: #da70d6;">/<em></em></span><br><span style="color: #da70d6;">ID:qcx97811</span><br><span style="color: #da70d6;">LANG:C</span><br><span style="color: #da70d6;">TASK:POJ_1704</span><br><span style="color: #da70d6;">/</span><br><span style="color: #eeee00;">#include <stdio.h></stdio.h></span><br><span style="color: #eeee00;">#include <stdlib.h></stdlib.h></span><br><span style="color: #eeee00;">#include <string.h></string.h></span><br><span style="color: #eeee00;">#include <math.h></math.h></span><br><br><span style="color: #98fb98; font-weight: bold;">int</span> n<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">t</span><br><span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #f5deb3;">num</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">1006</span><span style="color: #f5deb3;">],</span><span style="color: #f5deb3;">nim</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">1006</span><span style="color: #f5deb3;">],</span><span style="color: #f5deb3;">idx</span><br><span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #ffffff;">cmp</span>(<span style="color: #b0c4de; font-weight: bold;">const</span> <span style="color: #98fb98; font-weight: bold;">void</span> <span style="color: #f5deb3;"><em></em></span><span style="color: #f5deb3;">a</span><span style="color: #f5deb3;">,</span><span style="color: #b0c4de; font-weight: bold;">const</span> <span style="color: #98fb98; font-weight: bold;">void</span> <span style="color: #f5deb3;"></span>b)<br><span style="color: #f5deb3;">{</span><br>    <span style="color: #b0c4de; font-weight: bold;">if</span>((<span style="color: #f5deb3;"><em></em></span>(<span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #f5deb3;"></span>)<span style="color: #f5deb3;">a</span>) <span style="color: #f5deb3;">&gt;</span> (<span style="color: #f5deb3;"><em></em></span>(<span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #f5deb3;"></span>)b))<br>        <span style="color: #b0c4de; font-weight: bold;">return</span> <span style="color: #add8e6;">1</span><br>    <span style="color: #b0c4de; font-weight: bold;">if</span>((<span style="color: #f5deb3;"><em></em></span>(<span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #f5deb3;"></span>)<span style="color: #f5deb3;">a</span>) <span style="color: #f5deb3;">&lt;</span> (<span style="color: #f5deb3;"><em></em></span>(<span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #f5deb3;"></span>)b))<br>        <span style="color: #b0c4de; font-weight: bold;">return</span> <span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><br>    <span style="color: #b0c4de; font-weight: bold;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span><br><span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #ffffff;">main</span>(<span style="color: #98fb98; font-weight: bold;">void</span>)<br><span style="color: #f5deb3;">{</span><br>    <span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">k</span><br>    <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span><span style="color: #f5deb3;">t</span>);<br>    <span style="color: #b0c4de; font-weight: bold;">while</span>(<span style="color: #f5deb3;">t</span><span style="color: #f5deb3;">–</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span>n);<br>            <span style="color: #b0c4de; font-weight: bold;">for</span>(<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">=</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">&lt;</span>n;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>                <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span><span style="color: #f5deb3;">num</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]);</span><br>            <span style="color: #f5deb3;">num</span><span style="color: #f5deb3;">[</span>n<span style="color: #f5deb3;">]</span><span style="color: #f5deb3;">=</span><span style="color: #add8e6;">0</span><br>            <span style="color: #f5deb3;">qsort</span>(<span style="color: #f5deb3;">num</span><span style="color: #f5deb3;">,</span>n<span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">,</span><span style="color: #b0c4de; font-weight: bold;">sizeof</span>(<span style="color: #f5deb3;">num</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">]),</span><span style="color: #f5deb3;">cmp</span>);<br>            <span style="color: #b0c4de; font-weight: bold;">for</span>(<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">=</span>n<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">=</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">&gt;;</span><span style="color: #add8e6;">0</span>;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">–</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">++</span>)<br>                <span style="color: #f5deb3;">{</span><br>                    <span style="color: #f5deb3;">nim</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">]</span><span style="color: #f5deb3;">=</span><span style="color: #f5deb3;">num</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span><span style="color: #f5deb3;">-</span><span style="color: #f5deb3;">num</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">]</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><br>                <span style="color: #f5deb3;">}</span><br>            <span style="color: #f5deb3;">k</span><span style="color: #f5deb3;">=</span><span style="color: #add8e6;">0</span><br>            <span style="color: #b0c4de; font-weight: bold;">for</span>(<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">=</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">&lt;</span><span style="color: #f5deb3;">j</span>;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">+=</span><span style="color: #add8e6;">2</span>)<br>                <span style="color: #f5deb3;">k</span><span style="color: #f5deb3;">^=</span><span style="color: #f5deb3;">nim</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><br>            <span style="color: #b0c4de; font-weight: bold;">if</span>(<span style="color: #add8e6;">0</span><span style="color: #f5deb3;">==</span><span style="color: #f5deb3;">k</span>)<br>                <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“Bob will win</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span>);<br>            <span style="color: #b0c4de; font-weight: bold;">else</span><br>                <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“Georgia will win</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span>);<br>        <span style="color: #f5deb3;">}</span><br>    <span style="color: #b0c4de; font-weight: bold;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span></div>

	
	</div>
</div>

	  
      </div>
	  <div>
	    <center>
	    <div class="pagination">
<ul class="pagination">
	 
</ul>
</div>

        </center>
	    </div>	
      

</div> <!-- col-md-9/col-md-12 -->


<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
	<div class="widget">
		<h4>Categories</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/ACM/">ACM<span>16</span></a></li>
		
			<li><a href="/categories/Algorithm/">Algorithm<span>14</span></a></li>
		
			<li><a href="/categories/HDU/">HDU<span>9</span></a></li>
		
			<li><a href="/categories/ACM/HDU/">HDU<span>1</span></a></li>
		
			<li><a href="/categories/Linux/">Linux<span>32</span></a></li>
		
			<li><a href="/categories/POJ/">POJ<span>6</span></a></li>
		
			<li><a href="/categories/Linux/TeX/">TeX<span>1</span></a></li>
		
			<li><a href="/categories/USACO/">USACO<span>21</span></a></li>
		
			<li><a href="/categories/Uncategorized/">Uncategorized<span>3</span></a></li>
		
			<li><a href="/categories/Visual-C/">Visual C++<span>1</span></a></li>
		
			<li><a href="/categories/wordpress/">wordpress<span>8</span></a></li>
		
			<li><a href="/categories/具体数学/">具体数学<span>2</span></a></li>
		
			<li><a href="/categories/分布式系统/">分布式系统<span>8</span></a></li>
		
			<li><a href="/categories/分布式系统/实时计算/">实时计算<span>4</span></a></li>
		
			<li><a href="/categories/实时计算/">实时计算<span>6</span></a></li>
		
			<li><a href="/categories/想清楚/">想清楚<span>1</span></a></li>
		
			<li><a href="/categories/成长/">成长<span>3</span></a></li>
		
			<li><a href="/categories/我的生活/">我的生活<span>8</span></a></li>
		
			<li><a href="/categories/所谓开源/">所谓开源<span>3</span></a></li>
		
			<li><a href="/categories/数学/">数学<span>2</span></a></li>
		
			<li><a href="/categories/POJ/数学/">数学<span>2</span></a></li>
		
			<li><a href="/categories/Algorithm/数学/">数学<span>1</span></a></li>
		
			<li><a href="/categories/源码阅读/">源码阅读<span>1</span></a></li>
		
			<li><a href="/categories/Linux/计算机图形学图像处理/">计算机图形学图像处理<span>1</span></a></li>
		
			<li><a href="/categories/计算机图形学图像处理/">计算机图形学图像处理<span>1</span></a></li>
		
			<li><a href="/categories/计算机基础/">计算机基础<span>22</span></a></li>
		
			<li><a href="/categories/Linux/计算机基础/">计算机基础<span>2</span></a></li>
		
			<li><a href="/categories/所谓开源/计算机基础/">计算机基础<span>1</span></a></li>
		
			<li><a href="/categories/Algorithm/计算机基础/">计算机基础<span>1</span></a></li>
		
			<li><a href="/categories/计算机安全/">计算机安全<span>3</span></a></li>
		
			<li><a href="/categories/语言学习/">语言学习<span>1</span></a></li>
		
			<li><a href="/categories/计算机基础/语言学习/">语言学习<span>1</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/tutorial/">tutorial<span>1</span></a></li>
		
			<li><a href="/tags/博弈/">博弈<span>3</span></a></li>
		
			<li><a href="/tags/code/">code<span>1</span></a></li>
		
			<li><a href="/tags/rbtree/">rbtree<span>1</span></a></li>
		
			<li><a href="/tags/spark-streaming/">spark-streaming<span>7</span></a></li>
		
			<li><a href="/tags/horn-formulas/">horn formulas<span>1</span></a></li>
		
			<li><a href="/tags/chrome/">chrome<span>1</span></a></li>
		
			<li><a href="/tags/gdb/">gdb<span>2</span></a></li>
		
			<li><a href="/tags/数论/">数论<span>5</span></a></li>
		
			<li><a href="/tags/剪枝/">剪枝<span>1</span></a></li>
		
			<li><a href="/tags/shortest-paths-in-dag/">shortest paths in dag<span>1</span></a></li>
		
			<li><a href="/tags/how/">how<span>1</span></a></li>
		
			<li><a href="/tags/米聊/">米聊<span>1</span></a></li>
		
			<li><a href="/tags/kafka/">kafka<span>10</span></a></li>
		
			<li><a href="/tags/grouping/">grouping<span>1</span></a></li>
		
			<li><a href="/tags/select/">select<span>2</span></a></li>
		
			<li><a href="/tags/rpm/">rpm<span>1</span></a></li>
		
			<li><a href="/tags/huffman-encoding/">huffman encoding<span>1</span></a></li>
		
			<li><a href="/tags/storm/">storm<span>3</span></a></li>
		
			<li><a href="/tags/program/">program<span>1</span></a></li>
		
		
		   <li><a href="/tags">...<span>266</span></a></li>
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2017/06/03/Streaming-程序调用-Producer-close-hang-住问题追查复盘/" ><i class="fa fa-file-o"></i>Streaming 程序调用 Producer.clo...</a>
      </li>
    
      <li>
        <a href="/2017/06/01/如何在不重启-Spark-Streaming-作业的情况下，增加消费的-topic/" ><i class="fa fa-file-o"></i>如何在不重启 Spark Streaming 作业的情...</a>
      </li>
    
      <li>
        <a href="/2017/05/29/从源码级别分析-metric-core-的抽样算法/" ><i class="fa fa-file-o"></i>从源码级别分析 metric-core 的抽样算法</a>
      </li>
    
      <li>
        <a href="/2017/02/16/spark-streaming-consume-kafka-at-00-second-of-every-minute/" ><i class="fa fa-file-o"></i>Spark Streaming 统一在每分钟的 00 ...</a>
      </li>
    
      <li>
        <a href="/2017/01/15/spark-streaming-e5-be-80-hdfs-e8-bf-bd-e5-8a-a0-lzo-e6-96-87-e4-bb-b6/" ><i class="fa fa-file-o"></i>Spark Streaming 往 HDFS 追加 L...</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="http://www.github.com/klion26" title="My Github account." target="_blank"]);">My Github</a></li>
	
		<li><i class=""></i><a href="http://l34rner.github.io/" title="A blog focus on security!" target="_blank"]);">Debug0</a></li>
	
		<li><i class=""></i><a href="http://www.programlife.net/" title="程序人生" target="_blank"]);">代码疯子</a></li>
	
		<li><i class=""></i><a href="http://www.narutoacm.com/" title="NARUTOACM" target="_blank"]);">NARUTOACM</a></li>
	
		<li><i class=""></i><a href="http://www.tanglei.name/" title="tanglei 的 blog" target="_blank"]);">tanglei的blog</a></li>
	
		<li><i class=""></i><a href="http://www.microspaze.com/" title="微空间" target="_blank"]);">微空间</a></li>
	
		<li><i class=""></i><a href="http://www.toutian.org/" title="小昭的荒地" target="_blank"]);">小昭的荒地</a></li>
	
		<li><i class=""></i><a href="https://cosx.me/" title="异想天开" target="_blank"]);">异想天开</a></li>
	
		<li><i class=""></i><a href="http://www.xpc-yx.com/" title="远行" target="_blank"]);">远行</a></li>
	
		<li><i class=""></i><a href="http://www.zhangxc.com/" title="张学程" target="_blank"]);">张学程</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->




	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2017 klion26
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
