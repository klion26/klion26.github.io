<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>第 17 页 | klion26</title>
  <meta name="author" content="klion26">
  
  <meta name="description" content="个人博客，记录自己成长的点点滴滴">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="klion26"/>

  
    <meta property="og:image" content="undefined"/>
  

  
    <link rel="alternative" href="/atom.xml" title="klion26" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/bootstrap.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">klion26</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/resume" title="Resume">
			  <i class=""></i>Resume
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header page-header-inverse ">
  <h1 class="title title-inverse ">klion26</h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">
      <i class="fa fa-heart"></i>
      做中学, 学中做
</div>    
		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
        <!-- render top articles firstly -->
        
        <!-- render other articles -->
        
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-02-11 </div>
			<div class="article-title"><a href="/2011/02/11/usaco-4-2-2-the-perfect-stall-dinic/" >USACO 4-2-2 The Perfect Stall --网络流dinic算法</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p><a href="http://www.nocow.cn/index.php/Translate:USACO/stall4" target="_blank" rel="external">题意</a></p>
<p>利用这题学习了下dinic.题意就不说了,很容易理解的一题</p>
<p>以前网络流的算法一直只懂最白痴的EK,后来大家说sap是万能的,于是就想学学sap,可是找了些资料之后发现我先学会的是dinic.下面说说我的理解吧.如有错误还请指出.<br>首先说明下层次图的概念:对原图的每一个点设置一个层次,这个新图就成了所谓的层次图了.然后允许弧就是层次图中有边且原图中也有边的弧.<br>dinic就是利用层次图,然后每次找增广路径的时候就只走允许弧,如果单纯这样的话,个人认为和EK算法还是差不了多少的,毕竟dinic也是多次bfs然后再dfs找增广路,那我不还如EK呢,何况EK还简单不易写错.dinic的精华应该是退栈,也就是dfs找到一条增广路之后,并不是再从源点开始找一次,而是退到从源点可达的最远一个点[这样说来很抽象]比如下面的例子<br>ab = 10  bc = 5 cd = 5 bf=5 fd=5 de=10[abcdef是顶点]<br>那么源点是a汇点是f的话<br>栈中情况是a-&gt;ab-&gt;abc-&gt;abcd-&gt;abcde–增广—然后退到b因为b是栈中a现在能够到达的最远的顶点了.现在从b开始增广就会出现时ab-&gt;abf-&gt;abfd-&gt;abfde—增广也就是dinic的精华在这里;具体的大家可以看2007年王上欣的论文&lt;浅谈基于分层思想的网络流算法&gt;<br>下面给出我的一份代码,经供参考</p>
<p><div class="source" style="color: #f5deb3; font-family: 'Courier New','Lucida Console','monospace'; background-color: #2f4f4f;"><span style="color: #da70d6;">/<em></em></span><br><span style="color: #da70d6;">ID:qcx97811</span><br><span style="color: #da70d6;">LANG:C</span><br><span style="color: #da70d6;">TASK:stall4</span><br><span style="color: #da70d6;">/</span><br><span style="color: #eeee00;">#include <stdio.h></stdio.h></span><br><span style="color: #eeee00;">#include <stdlib.h></stdlib.h></span><br><span style="color: #eeee00;">#include <string.h></string.h></span><br><span style="color: #eeee00;">#include <limits.h></limits.h></span></div><br><span style="font-weight: bold; color: #98fb98;">int</span> N<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">maxflow</span><span style="color: #da70d6;">//N和M是题目中的意思 maxflow就是最大流的值</span><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">406</span><span style="color: #f5deb3;">][</span><span style="color: #add8e6;">406</span><span style="color: #f5deb3;">],</span><span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">406</span><span style="color: #f5deb3;">],</span><span style="color: #f5deb3;">d</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">406</span><span style="color: #f5deb3;">];</span><span style="color: #da70d6;">//graph是图 pre是每个节点的前驱 d表示每个节点的层次</span></p>
<p><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">outdegree</span>(<span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">now</span>)<br><span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//返回传入顶点的出度包括在层次图中的信息</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">out</span><br>    <span style="color: #f5deb3;">out</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #da70d6;">//out代表传入顶点的出度</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;=</span> (N<span style="color: #f5deb3;">+</span><span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span>);<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>        <span style="font-weight: bold; color: #b0c4de;">if</span>(((<span style="color: #f5deb3;">d</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">now</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">+</span> <span style="color: #add8e6;">1</span>) <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">d</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">])</span> <span style="color: #f5deb3;">&amp;</span> <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">now</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&gt;</span> <span style="color: #add8e6;">0</span>)<br>            <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//这里用break是因为只需要知道出度是否为0 不需要知道度为多少</span><br>                <span style="color: #f5deb3;">out</span><span style="color: #f5deb3;">++</span><br>                <span style="font-weight: bold; color: #b0c4de;">break</span><br>            <span style="color: #f5deb3;">}</span><br>    <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #f5deb3;">out</span><br><span style="color: #f5deb3;">}</span><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">dinic</span>()<br><span style="color: #f5deb3;">{</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">front</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">u</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">out</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">top</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">add</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">406</span><span style="color: #f5deb3;">];</span><br>    <span style="color: #f5deb3;">maxflow</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><br>    <span style="font-weight: bold; color: #b0c4de;">while</span>(<span style="color: #add8e6;">1</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #da70d6;">//通过bfs重构层次图</span><br>            <span style="color: #f5deb3;">memset</span>(<span style="color: #f5deb3;">d</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">sizeof</span>(<span style="color: #f5deb3;">d</span>));<br>            <span style="color: #f5deb3;">memset</span>(<span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">sizeof</span>(<span style="color: #f5deb3;">pre</span>));<br>            <span style="color: #f5deb3;">d</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #da70d6;">//这里pre数组相当于一个bool数组记录某个顶点是否被用</span><br>            <span style="color: #f5deb3;">rear</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">front</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><br>            <span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">++</span><br>            <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><br>            <span style="font-weight: bold; color: #b0c4de;">while</span>(<span style="color: #f5deb3;">front</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #f5deb3;">rear</span>)<br>                <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//bfs构建层次图</span><br>                    <span style="color: #f5deb3;">u</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">++</span><span style="color: #f5deb3;">front</span><span style="color: #f5deb3;">];</span><br>                    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;=</span> (N<span style="color: #f5deb3;">+</span><span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span>);<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>                        <span style="color: #f5deb3;">{</span><br>                            <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&amp;</span> <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">u</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&gt;</span> <span style="color: #add8e6;">0</span>)<br>                                <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//如果这个点没有被用而且残留网络中有边</span><br>                                    <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">u</span><span style="color: #da70d6;">//记录当前顶点已经被用</span><br>                                    <span style="color: #f5deb3;">d</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">d</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">u</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">+</span> <span style="color: #add8e6;">1</span><span style="color: #da70d6;">//层次加1</span><br>                                    <span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">++</span><span style="color: #da70d6;">//入队</span><br>                                    <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">i</span><br>                                <span style="color: #f5deb3;">}</span><br>                        <span style="color: #f5deb3;">}</span><br>                <span style="color: #f5deb3;">}</span></p>
<pre><code>    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;if&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;pre&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;N&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;M&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;])&lt;/span&gt;
        &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;break&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//如果汇点不在层次图中标明已无增广路径&lt;/span&gt;

    &lt;span style=&quot;color: #f5deb3;&quot;&gt;out&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;outdegree&lt;/span&gt;(&lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;);

    &lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;
    &lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//这里的q是用来记录增广路径上的点&lt;/span&gt;
    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;while&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;out&lt;/span&gt;)&lt;span style=&quot;color: #da70d6;&quot;&gt;//循环直到源点的出度为0&lt;/span&gt;
        &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;
            &lt;span style=&quot;color: #f5deb3;&quot;&gt;u&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;];&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//取栈顶元素&lt;/span&gt;
            &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;if&lt;/span&gt;((N&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;M&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;) &lt;span style=&quot;color: #f5deb3;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;u&lt;/span&gt;)&lt;span style=&quot;color: #da70d6;&quot;&gt;//如果已经找到一条增广路径&lt;/span&gt;
                &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//增广 然后队列回退到从源点可达的最远点&lt;/span&gt;
                    &lt;span style=&quot;color: #f5deb3;&quot;&gt;add&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;INT_MAX&lt;/span&gt;
                    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;for&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;&lt;&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt;;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;++&lt;/span&gt;)
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//判定本次可增广的流量&lt;/span&gt;
                            &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;if&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;graph&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]][&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]]&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;&lt;&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;add&lt;/span&gt;)
                                &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;
                                    &lt;span style=&quot;color: #f5deb3;&quot;&gt;add&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;graph&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]][&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]];&lt;/span&gt;
                                &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;   
                    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;for&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;&lt;&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt;;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;++&lt;/span&gt;)
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//更新残留网络&lt;/span&gt;
                            &lt;span style=&quot;color: #f5deb3;&quot;&gt;graph&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]][&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]]&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;-=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;add&lt;/span&gt;
                            &lt;span style=&quot;color: #f5deb3;&quot;&gt;graph&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]][&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]]&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;+=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;add&lt;/span&gt;
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
                    &lt;span style=&quot;color: #f5deb3;&quot;&gt;maxflow&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;+=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;add&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//增加网络流量&lt;/span&gt;
                    &lt;span style=&quot;color: #da70d6;&quot;&gt;//下面回退到从源点可达的最远的一个点&lt;/span&gt;
                    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;for&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;&lt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt;;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;++&lt;/span&gt;)
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;
                            &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;if&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;outdegree&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;])&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;)
                                &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//这里不应该只考虑出度还应该考虑和q中的下一个元素是否有边(包括层次图和残留网络)&lt;/span&gt;
                                    &lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//这个地方如果出现top=-1应该也没问题的 因为这样的话out已经为0了&lt;/span&gt;
                                    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;break&lt;/span&gt;
                                &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
                            &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;if&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;graph&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]][&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]]&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;&lt;=&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;)
                                &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//这个是防止某个点出度不为0但是q中这个点和下一个点的边已经为0了 那么就会一直死循环在里面这个while里&lt;/span&gt;
                                    &lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;
                                    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;break&lt;/span&gt;
                                &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
                &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
            &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;else&lt;/span&gt;
                &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;
                    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;if&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;outdegree&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;u&lt;/span&gt;) &lt;span style=&quot;color: #f5deb3;&quot;&gt;&gt;&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;)
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//该点的出度不为0 则改变队列 把当前顶点入队这里的出度包括层次图的信息&lt;/span&gt;
                            &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;for&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;&lt;=&lt;/span&gt; (N&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;M&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;);&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;++&lt;/span&gt;)
                                &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//寻找u顶点的下一个顶点&lt;/span&gt;
                                    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;if&lt;/span&gt;(&lt;span style=&quot;color: #f5deb3;&quot;&gt;d&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;u&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;==&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;d&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;graph&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;u&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;][&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;&gt;&lt;/span&gt; &lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;)
                                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;
                                            &lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;++&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//入栈&lt;/span&gt;
                                            &lt;span style=&quot;color: #f5deb3;&quot;&gt;q&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;i&lt;/span&gt;
                                            &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;break&lt;/span&gt;
                                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
                                &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
                    &lt;span style=&quot;font-weight: bold; color: #b0c4de;&quot;&gt;else&lt;/span&gt;
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;{&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//弹出队列的最高顶点&lt;/span&gt;
                            &lt;span style=&quot;color: #f5deb3;&quot;&gt;d&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;u&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;]&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #add8e6;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//当前顶点从层次图中删除&lt;/span&gt;
                            &lt;span style=&quot;color: #f5deb3;&quot;&gt;top&lt;/span&gt;&lt;span style=&quot;color: #f5deb3;&quot;&gt;--&lt;/span&gt;&lt;span style=&quot;color: #da70d6;&quot;&gt;//从栈中删除&lt;/span&gt;
                        &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
                &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
            &lt;span style=&quot;color: #f5deb3;&quot;&gt;out&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: #f5deb3;&quot;&gt;outdegree&lt;/span&gt;(&lt;span style=&quot;color: #add8e6;&quot;&gt;0&lt;/span&gt;);&lt;span style=&quot;color: #da70d6;&quot;&gt;//判定当前源点的出度&lt;/span&gt;
        &lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
&lt;span style=&quot;color: #f5deb3;&quot;&gt;}&lt;/span&gt;
</code></pre><p><span style="color: #f5deb3;">}</span></p>
<p><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">main</span>(<span style="font-weight: bold; color: #98fb98;">void</span>)<br><span style="color: #f5deb3;">{</span><br>    <span style="color: #f5deb3;">freopen</span>(<span style="color: #7fffd4;">“stall4.in”</span><span style="color: #f5deb3;">,</span><span style="color: #7fffd4;">“r”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">stdin</span>);<br>    <span style="color: #f5deb3;">freopen</span>(<span style="color: #7fffd4;">“stall4.out”</span><span style="color: #f5deb3;">,</span><span style="color: #7fffd4;">“w”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">stdout</span>);<br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">ct</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">c</span><br>    <span style="color: #f5deb3;">memset</span>(<span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">,</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">sizeof</span>(<span style="color: #f5deb3;">graph</span>));<br>    <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span>N<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">&amp;</span><span style="color: #f5deb3;">M</span>);<br>    <span style="color: #da70d6;">/<em>下面是初始化图</em>/</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;=</span> N;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span><span style="color: #f5deb3;">ct</span>);<br>            <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #f5deb3;">ct</span>;<span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">++</span>)<br>                <span style="color: #f5deb3;">{</span><br>                    <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span><span style="color: #f5deb3;">c</span>);<br>                    <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">c</span><span style="color: #f5deb3;">+</span>N<span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><br>                <span style="color: #f5deb3;">}</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;=</span> N;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>        <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> N<span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;=</span> (N<span style="color: #f5deb3;">+</span><span style="color: #f5deb3;">M</span>);<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>        <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">][</span>N<span style="color: #f5deb3;">+</span><span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><br>    <span style="color: #da70d6;">/<em>上面是初始化图</em>/</span><br>    <span style="color: #f5deb3;">dinic</span>();<span style="color: #da70d6;">//调用dinic求最大流</span><br>    <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“%d</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">maxflow</span>);<span style="color: #da70d6;">//输出最大流</span><br>    <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span></p>

	
	</div>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-02-10 </div>
			<div class="article-title"><a href="/2011/02/10/networkflow-1-maximum-matching/" >网络流24题之一最大匹配</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p><a href="http://acm.nankai.edu.cn/p2121.html" target="_blank" rel="external">此处可提交</a></p>
<p>我用的还是最原始的EK算法,建图也比较简单,只要某两个人能配合好就给一个权值为1的边,然后增加一个超级源点和汇点,剩下的就是最大流了.不过最后输出时注意下(输出配对关系的时候),比如下面这组数据</p>
<p>2 4</p>
<p>1 3</p>
<p>1 4</p>
<p>2 3</p>
<p>-1 -1</p>
<p>代码如下:</p>
<div class="source" style="color: #f5deb3; font-family: 'Courier New','Lucida Console','monospace'; background-color: #2f4f4f;"><span style="color: #da70d6;">/<em></em></span><br><span style="color: #da70d6;">  LANG:C</span><br><span style="color: #da70d6;">  TASK:</span><br><span style="color: #da70d6;">  ID:qcx97811</span><br><span style="color: #da70d6;">/</span><br><span style="color: #eeee00;">#include <stdio.h></stdio.h></span><br><span style="color: #eeee00;">#include <stdlib.h></stdlib.h></span><br><span style="color: #eeee00;">#include <string.h></string.h></span><br><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">106</span><span style="color: #f5deb3;">][</span><span style="color: #add8e6;">106</span><span style="color: #f5deb3;">],</span><span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">106</span><span style="color: #f5deb3;">];</span><br><span style="font-weight: bold; color: #98fb98;">int</span> N<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">maxflow</span><br><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">bfs</span>()<br><span style="color: #f5deb3;">{</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">206</span><span style="color: #f5deb3;">];</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">front</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">rear</span><br>    <span style="color: #f5deb3;">memset</span>(<span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">sizeof</span>(<span style="color: #f5deb3;">pre</span>));<br>    <span style="color: #f5deb3;">front</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">rear</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><br>    <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">++</span><span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><br>    <span style="font-weight: bold; color: #b0c4de;">while</span>(<span style="color: #f5deb3;">front</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #f5deb3;">rear</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">++</span><span style="color: #f5deb3;">front</span><span style="color: #f5deb3;">];</span><br>            <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">&lt;=</span> (N<span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span>);<span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">++</span>)<br>                <span style="color: #f5deb3;">{</span><br>                    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&amp;</span> <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&gt;</span> <span style="color: #add8e6;">0</span>)<br>                        <span style="color: #f5deb3;">{</span><br>                            <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">i</span><br>                            <span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">++</span><br>                            <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">j</span><br>                            <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">==</span> (N<span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span>))<br>                                <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">1</span><br>                        <span style="color: #f5deb3;">}</span><br>                <span style="color: #f5deb3;">}</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span><br><span style="font-weight: bold; color: #98fb98;">void</span> <span style="color: #ffffff;">max_flow</span>()<br><span style="color: #f5deb3;">{</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">add</span><br>    <span style="color: #f5deb3;">maxflow</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><br>    <span style="font-weight: bold; color: #b0c4de;">while</span>(<span style="color: #add8e6;">0</span> <span style="color: #f5deb3;">!=</span> (<span style="color: #f5deb3;">add</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">bfs</span>()))<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">add</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">10000006</span><br>            <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> (N<span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span>);<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">!=</span> <span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">])</span><br>                <span style="color: #f5deb3;">{</span><br>                    <span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><br>                    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #f5deb3;">add</span>)<br>                        <span style="color: #f5deb3;">add</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><br>                <span style="color: #f5deb3;">}</span><br>            <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> (N<span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span>);<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">!=</span> <span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">])</span><br>                <span style="color: #f5deb3;">{</span><br>                    <span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><br>                    <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">-=</span> <span style="color: #f5deb3;">add</span><br>                    <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">+=</span> <span style="color: #f5deb3;">add</span><br>                <span style="color: #f5deb3;">}</span><br>            <span style="color: #f5deb3;">maxflow</span> <span style="color: #f5deb3;">+=</span> <span style="color: #f5deb3;">add</span><br>        <span style="color: #f5deb3;">}</span><br><span style="color: #f5deb3;">}</span><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">main</span>(<span style="font-weight: bold; color: #98fb98;">void</span>)<br><span style="color: #f5deb3;">{</span><br>    <span style="color: #f5deb3;">freopen</span>(<span style="color: #7fffd4;">“24-1.in”</span><span style="color: #f5deb3;">,</span><span style="color: #7fffd4;">“r”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">stdin</span>);<br>    <span style="color: #f5deb3;">freopen</span>(<span style="color: #7fffd4;">“24-1.out”</span><span style="color: #f5deb3;">,</span><span style="color: #7fffd4;">“w”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">stdout</span>);<br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">,</span>s<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">e</span><br>    <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span><span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">&amp;</span>N);<br>    <span style="color: #f5deb3;">memset</span>(<span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">,</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">sizeof</span>(<span style="color: #f5deb3;">graph</span>));<br>    <span style="font-weight: bold; color: #b0c4de;">while</span>(<span style="color: #add8e6;">1</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span>s<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">&amp;</span><span style="color: #f5deb3;">e</span>);<br>            <span style="font-weight: bold; color: #b0c4de;">if</span>((<span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span> <span style="color: #f5deb3;">==</span> s) <span style="color: #f5deb3;">&amp;</span> (<span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">e</span>))<br>                <span style="font-weight: bold; color: #b0c4de;">break</span><br>            <span style="font-weight: bold; color: #b0c4de;">if</span>(s <span style="color: #f5deb3;">&gt;</span> <span style="color: #f5deb3;">e</span>)<br>                <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//确定是从一个方向流往另外一个方向</span><br>                    <span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> s;<br>                    s <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">e</span><br>                    <span style="color: #f5deb3;">e</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">i</span><br>                <span style="color: #f5deb3;">}</span><br>            <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span>s<span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">e</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;=</span> <span style="color: #f5deb3;">M</span>;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<span style="color: #da70d6;">//超级源点</span><br>        <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;=</span> N;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<span style="color: #da70d6;">//超级汇点</span><br>        <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">][</span>N<span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><br>    <span style="color: #f5deb3;">max_flow</span>();<br>    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #add8e6;">0</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">maxflow</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“No Solution</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span>);<br>        <span style="color: #f5deb3;">}</span><br>    <span style="font-weight: bold; color: #b0c4de;">else</span><br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“%d</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">maxflow</span>);<br>            <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;=</span> <span style="color: #f5deb3;">M</span>;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>                <span style="color: #f5deb3;">{</span><br>                    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">=</span> (<span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span>);<span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">&lt;=</span> N;<span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">++</span>)<br>                        <span style="color: #f5deb3;">{</span><br>                            <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">==</span> <span style="color: #add8e6;">1</span>)<br>                                <span style="color: #f5deb3;">{</span><br>                                    <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“%d %d</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span>);<br>                                <span style="color: #da70d6;">//这里的输出注意下 附数据如下</span><br>                                <span style="color: #da70d6;">//2 4</span><br>                                <span style="color: #da70d6;">//1 3</span><br>                                <span style="color: #da70d6;">//1 4</span><br>                                <span style="color: #da70d6;">//2 3</span><br>                                <span style="color: #da70d6;">//-1 -1</span><br>                                <span style="color: #f5deb3;">}</span><br>                        <span style="color: #f5deb3;">}</span><br>                <span style="color: #f5deb3;">}</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span></div>

	
	</div>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-02-10 </div>
			<div class="article-title"><a href="/2011/02/10/usaco-4-2-1-drainage-ditches/" >USACO 4-2-1Drainage Ditches</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p><a href="http://www.nocow.cn/index.php/Translate:USACO/ditch" target="_blank" rel="external">题目翻译</a></p>
<p>一个入门的网络流题目,由于点和边都不多,所以我用了原始的EK算法(其实当时我也只会这最原始的算法),也就是每次用bfs找增广路,复杂度是O(V*E^2)。下面直接给出代码</p>
<div class="source" style="color: #f5deb3; font-family: 'Courier New','Lucida Console','monospace'; background-color: #2f4f4f;"><span style="color: #da70d6;">/<em></em></span><br><span style="color: #da70d6;">  LANG:C</span><br><span style="color: #da70d6;">  TASK:ditch</span><br><span style="color: #da70d6;">  ID:qcx97811</span><br><span style="color: #da70d6;">/</span><br><span style="color: #eeee00;">#include <stdio.h></stdio.h></span><br><span style="color: #eeee00;">#include <stdlib.h></stdlib.h></span><br><span style="color: #eeee00;">#include <string.h></string.h></span><br><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">206</span><span style="color: #f5deb3;">][</span><span style="color: #add8e6;">206</span><span style="color: #f5deb3;">],</span><span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">206</span><span style="color: #f5deb3;">];</span><span style="color: #da70d6;">//graph是原图,pre是用来存每个点的前驱的</span><br><span style="font-weight: bold; color: #98fb98;">int</span> N<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">maxflow</span><span style="color: #da70d6;">//N和M是题中的 maxlfow就是结果了</span><br><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">bfs</span>()<br><span style="color: #f5deb3;">{</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">206</span><span style="color: #f5deb3;">];</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">front</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">rear</span><br>    <span style="color: #f5deb3;">memset</span>(<span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">sizeof</span>(<span style="color: #f5deb3;">pre</span>));<br>    <span style="color: #f5deb3;">front</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">rear</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><br>    <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">++</span><span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><br>    <span style="font-weight: bold; color: #b0c4de;">while</span>(<span style="color: #f5deb3;">front</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #f5deb3;">rear</span>)<span style="color: #da70d6;">//bfs找一条从源点到汇点的路径</span><br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">++</span><span style="color: #f5deb3;">front</span><span style="color: #f5deb3;">];</span><br>            <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">&lt;=</span> <span style="color: #f5deb3;">M</span>;<span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">++</span>)<br>                <span style="color: #f5deb3;">{</span><br>                    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&amp;</span> <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&gt;</span> <span style="color: #add8e6;">0</span>)<br>                        <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//如果当前点没有没用而且可用</span><br>                            <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">i</span><br>                            <span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">++</span><br>                            <span style="color: #f5deb3;">q</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rear</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">j</span><br>                            <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">M</span>)<span style="color: #da70d6;">//如果已经到了汇点 也就是已经找到一条增广路径</span><br>                                <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">1</span><br>                        <span style="color: #f5deb3;">}</span><br>                <span style="color: #f5deb3;">}</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span><br><span style="font-weight: bold; color: #98fb98;">void</span> <span style="color: #ffffff;">max_flow</span>()<br><span style="color: #f5deb3;">{</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">add</span><br>    <span style="color: #f5deb3;">maxflow</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><br>    <span style="font-weight: bold; color: #b0c4de;">while</span>(<span style="color: #add8e6;">0</span> <span style="color: #f5deb3;">!=</span> (<span style="color: #f5deb3;">add</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">bfs</span>()))<br>        <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//如果还有增广路径</span><br>            <span style="color: #f5deb3;">add</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">10000006</span><br>            <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">!=</span> <span style="color: #add8e6;">1</span>;<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">])</span><br>                <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//找出本次能增广的最大流量</span><br>                    <span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><br>                    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #f5deb3;">add</span>)<br>                        <span style="color: #f5deb3;">add</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><br>                <span style="color: #f5deb3;">}</span><br>            <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">M</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">!=</span> <span style="color: #add8e6;">1</span>;<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">])</span><br>                <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//改变残留网络</span><br>                    <span style="color: #f5deb3;">j</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">pre</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><br>                    <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">-=</span> <span style="color: #f5deb3;">add</span><br>                    <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">j</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">+=</span> <span style="color: #f5deb3;">add</span><br>                <span style="color: #f5deb3;">}</span><br>            <span style="color: #f5deb3;">maxflow</span> <span style="color: #f5deb3;">+=</span> <span style="color: #f5deb3;">add</span><span style="color: #da70d6;">//更改结果</span><br>        <span style="color: #f5deb3;">}</span><br><span style="color: #f5deb3;">}</span><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">main</span>(<span style="font-weight: bold; color: #98fb98;">void</span>)<br><span style="color: #f5deb3;">{</span><br>    <span style="color: #f5deb3;">freopen</span>(<span style="color: #7fffd4;">“ditch.in”</span><span style="color: #f5deb3;">,</span><span style="color: #7fffd4;">“r”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">stdin</span>);<br>    <span style="color: #f5deb3;">freopen</span>(<span style="color: #7fffd4;">“ditch.out”</span><span style="color: #f5deb3;">,</span><span style="color: #7fffd4;">“w”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">stdout</span>);<br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">,</span>s<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">e</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">c</span><br>    <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span>N<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">&amp;</span><span style="color: #f5deb3;">M</span>);<br>    <span style="color: #f5deb3;">memset</span>(<span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">,</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">sizeof</span>(<span style="color: #f5deb3;">graph</span>));<br>    <span style="color: #da70d6;">//下面是建图</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;</span> N;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d%d%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span>s<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">&amp;</span><span style="color: #f5deb3;">e</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">&amp;</span><span style="color: #f5deb3;">c</span>);<br>            <span style="color: #f5deb3;">graph</span><span style="color: #f5deb3;">[</span>s<span style="color: #f5deb3;">][</span><span style="color: #f5deb3;">e</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">+=</span> <span style="color: #f5deb3;">c</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="color: #f5deb3;">max_flow</span>();<span style="color: #da70d6;">//调用max_flow得到结果</span><br>    <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“%d</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">maxflow</span>);<br>    <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span></div>

	
	</div>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2011-02-10 </div>
			<div class="article-title"><a href="/2011/02/10/usaco-4-1-2-fence-rails/" >USACO 4-1-2 Fence Rails</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p><a href="http://www.nocow.cn/index.php/Translate:USACO/fence8" target="_blank" rel="external">题目翻译</a></p>
<p>这题一开始不知如何下手,后来参考了nocow和其他大牛的才写出来的.这里就给出nocow的分析再贴上代码,这题说是dfs-id算法,可是我怎么看都觉得是一般的dfs然后加剪枝.</p>
<p>nocow分析<a href="http://www.nocow.cn/index.php/USACO/fence8" target="_blank" rel="external">见这里</a></p>
<p>下面是我的代码:</p>
<div class="source" style="color: #f5deb3; font-family: 'Courier New','Lucida Console','monospace'; background-color: #2f4f4f;"><span style="color: #da70d6;">/<em></em></span><br><span style="color: #da70d6;">  ID:qcx97811</span><br><span style="color: #da70d6;">  LANG:C</span><br><span style="color: #da70d6;">  TASK:fence8</span><br><span style="color: #da70d6;">/</span><br><span style="color: #eeee00;">#include <stdio.h></stdio.h></span><br><span style="color: #eeee00;">#include <stdlib.h></stdlib.h></span><br><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">56</span><span style="color: #f5deb3;">],</span><span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">1026</span><span style="color: #f5deb3;">],</span><span style="color: #f5deb3;">rail_sum</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">1026</span><span style="color: #f5deb3;">];</span><br><span style="font-weight: bold; color: #98fb98;">int</span> N<span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">R</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">bsum</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">up</span><br><br><span style="color: #da70d6;">//排序用的模板</span><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">cmp</span>(<span style="font-weight: bold; color: #b0c4de;">const</span> <span style="font-weight: bold; color: #98fb98;">void</span> <span style="color: #f5deb3;"><em></em></span><span style="color: #f5deb3;">a</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">const</span> <span style="font-weight: bold; color: #98fb98;">void</span> <span style="color: #f5deb3;"></span>b)<br><span style="color: #f5deb3;">{</span><br>    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;"><em></em></span>(<span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;"></span>)<span style="color: #f5deb3;">a</span> <span style="color: #f5deb3;">&gt;</span> <span style="color: #f5deb3;"><em></em></span>(<span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;"></span>)b)<br>        <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">1</span><br>    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;"><em></em></span>(<span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;"></span>)<span style="color: #f5deb3;">a</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;"><em></em></span>(<span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;"></span>)b)<br>        <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">0</span><br>    <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><br><span style="color: #f5deb3;">}</span><br><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">work</span>(<span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">total</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">rstart</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">bstart</span>)<br><span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//total是到当前已经浪费掉的木板长度</span><br><span style="color: #da70d6;">//rstart更准确的是rend也就是当前的最大rail下标 因为是从大到小</span><br><span style="color: #da70d6;">//bstart是当前从哪块board开始的</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">t_bstart</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">t_total</span><br>    <span style="color: #f5deb3;">t_total</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><br>    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">rstart</span>)<span style="color: #da70d6;">//表示搜索已经结束了</span><br>        <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">1</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> N<span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&gt;;=</span> <span style="color: #f5deb3;">bstart</span>;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">–</span>)<br>        <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//搜索 从大到小</span><br>            <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&gt;=</span> <span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rstart</span><span style="color: #f5deb3;">])</span><br>                <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//如果可以从这个board上切的话</span><br>                    <span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">-=</span> <span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rstart</span><span style="color: #f5deb3;">];</span><span style="color: #da70d6;">//更新board</span><br>                    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">])</span><br>                        <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//如果这个board已经不可能再切出其他rail了</span><br>                            <span style="color: #f5deb3;">t_total</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">total</span><span style="color: #f5deb3;">+</span><span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><span style="color: #da70d6;">//更新浪费的board总数</span><br>                            <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">t_total</span><span style="color: #f5deb3;">+</span><span style="color: #f5deb3;">rail_sum</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">up</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&gt;</span> <span style="color: #f5deb3;">bsum</span>)<br>                                <span style="color: #f5deb3;">{</span><span style="color: #da70d6;">//如果已经不可能切出up+1[搜索的是下标]个rail</span><br>                                    <span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">+=</span> <span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rstart</span><span style="color: #f5deb3;">];</span><span style="color: #da70d6;">//回溯</span><br>                                    <span style="font-weight: bold; color: #b0c4de;">continue</span><span style="color: #da70d6;">//进行下次个搜索</span><br>                                <span style="color: #f5deb3;">}</span><br>                        <span style="color: #f5deb3;">}</span><br>                    <span style="font-weight: bold; color: #b0c4de;">else</span><br>                        <span style="color: #f5deb3;">t_total</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">total</span><span style="color: #da70d6;">//浪费的board</span><br>                    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #f5deb3;">rstart</span> <span style="color: #f5deb3;">&gt;</span> <span style="color: #add8e6;">0</span> <span style="color: #f5deb3;">&amp;</span> (<span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rstart</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rstart</span><span style="color: #f5deb3;">]))</span><br>                        <span style="color: #f5deb3;">t_bstart</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">i</span><span style="color: #da70d6;">//如果下一块rail和当前的rail相等</span><br>                    <span style="color: #da70d6;">//那么下一块rail所对应的board一定比当前rail所对应的</span><br>                    <span style="color: #da70d6;">//board的下标要大 至少不会小</span><br>                    <span style="font-weight: bold; color: #b0c4de;">else</span><br>                        <span style="color: #f5deb3;">t_bstart</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #da70d6;">//board的最小下标为0 这里不用考虑某块board已经被用 因为每次都会更新board的大小</span><br>                    <span style="font-weight: bold; color: #b0c4de;">if</span>(<span style="color: #add8e6;">1</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">work</span>(<span style="color: #f5deb3;">t_total</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">rstart</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">t_bstart</span>))<br>                        <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">1</span><span style="color: #da70d6;">//如果搜索成功的话 就返回成功</span><br>                    <span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">+=</span> <span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">rstart</span><span style="color: #f5deb3;">];</span><br>                <span style="color: #f5deb3;">}</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span><br><span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #ffffff;">main</span>(<span style="font-weight: bold; color: #98fb98;">void</span>)<br><span style="color: #f5deb3;">{</span><br>    <span style="color: #f5deb3;">freopen</span>(<span style="color: #7fffd4;">“fence8.in”</span><span style="color: #f5deb3;">,</span><span style="color: #7fffd4;">“r”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">stdin</span>);<br>    <span style="color: #f5deb3;">freopen</span>(<span style="color: #7fffd4;">“fence8.out”</span><span style="color: #f5deb3;">,</span><span style="color: #7fffd4;">“w”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">stdout</span>);<br>    <span style="font-weight: bold; color: #98fb98;">int</span> <span style="color: #f5deb3;">i</span><br>    <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span>N);<span style="color: #da70d6;">//N是board的数目</span><br>    <span style="color: #f5deb3;">bsum</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #da70d6;">//bsum用来记录所有board的总和 用于一个小剪枝</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;</span> N;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span><span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]);</span><br>            <span style="color: #f5deb3;">bsum</span> <span style="color: #f5deb3;">+=</span> <span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span><span style="color: #f5deb3;">R</span>);<span style="color: #da70d6;">//R是rail的的总数</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">0</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #f5deb3;">R</span>;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">scanf</span>(<span style="color: #7fffd4;">“%d”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;"></span><span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]);</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="color: #f5deb3;">qsort</span>(<span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">,</span>N<span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">sizeof</span>(<span style="color: #f5deb3;">board</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">]),</span><span style="color: #f5deb3;">cmp</span>);<br>    <span style="color: #f5deb3;">qsort</span>(<span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">R</span><span style="color: #f5deb3;">,</span><span style="font-weight: bold; color: #b0c4de;">sizeof</span>(<span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">]),</span><span style="color: #f5deb3;">cmp</span>);<br>    <span style="color: #da70d6;">//对board数组和rail数组进行从小到大的排序</span><br>    <span style="color: #da70d6;">//下面的rail_sum数组表示从rail[0]加到rail[i]的总和 也是用于剪枝    </span><br>    <span style="color: #f5deb3;">rail_sum</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #add8e6;">0</span><span style="color: #f5deb3;">];</span><br>    <span style="font-weight: bold; color: #b0c4de;">for</span>(<span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">=</span> <span style="color: #add8e6;">1</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #f5deb3;">R</span>;<span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">++</span>)<br>        <span style="color: #f5deb3;">{</span><br>            <span style="color: #f5deb3;">rail_sum</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">rail_sum</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">+</span> <span style="color: #f5deb3;">rail</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">i</span><span style="color: #f5deb3;">];</span><br>        <span style="color: #f5deb3;">}</span><br>    <span style="color: #f5deb3;">up</span> <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">R</span><span style="color: #f5deb3;">-</span><span style="color: #add8e6;">1</span><span style="color: #da70d6;">//up是有可能的最大下标</span><br>    <span style="font-weight: bold; color: #b0c4de;">while</span>(<span style="color: #f5deb3;">rail_sum</span><span style="color: #f5deb3;">[</span><span style="color: #f5deb3;">up</span><span style="color: #f5deb3;">]</span> <span style="color: #f5deb3;">&gt;</span> <span style="color: #f5deb3;">bsum</span>)<br>        <span style="color: #f5deb3;">up</span><span style="color: #f5deb3;">–</span><br><span style="color: #eeee00;">#if 0</span><br><span style="color: #da70d6;">    用于调试</span><br><span style="color: #da70d6;">    printf(“%d\n”,up);</span><br><span style="color: #eeee00;">#endif</span><br>    <span style="font-weight: bold; color: #b0c4de;">while</span>(<span style="color: #add8e6;">0</span> <span style="color: #f5deb3;">==</span> <span style="color: #f5deb3;">work</span>(<span style="color: #add8e6;">0</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">up</span><span style="color: #f5deb3;">,</span><span style="color: #add8e6;">0</span>))<span style="color: #da70d6;">//搜索结果</span><br>        <span style="color: #f5deb3;">up</span><span style="color: #f5deb3;">–</span><br>    <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“%d</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">up</span><span style="color: #f5deb3;">+</span><span style="color: #add8e6;">1</span>);<span style="color: #da70d6;">//由于搜索出来的是下标 所以结果得+1</span><br>    <span style="font-weight: bold; color: #b0c4de;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span></div>

	
	</div>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2010-12-31 </div>
			<div class="article-title"><a href="/2010/12/31/linux-fork-2/" >Linux-fork(2)</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>由于这篇会比较长,所以就不接在上一篇后面了,在此再开一篇.这里说说和fork有关的两个比较有趣的程序</p>
<p>第一个是这样的[一组,一共两个程序对比]</p>
<p><div class="source" style="color: #f5deb3; background-color: #2f4f4f; font-family: 'Courier New', 'Lucida Console', Verdana;"><span style="color: #eeee00;">#include <unistd.h>;</unistd.h></span><br><span style="color: #eeee00;">#include <sys types.h="">;</sys></span><br><span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #ffffff;">main</span> ()<br><span style="color: #f5deb3;">{</span><br><span style="color: #f5deb3;">pid_t</span> <span style="color: #f5deb3;">pid</span><br><span style="color: #f5deb3;">printf</span>(<span style="color: #f5deb3;">“</span><span style="color: #f5deb3;">fork</span><span style="color: #f5deb3;">”</span>);<span style="color: #da70d6;">//注意这句和下面的区别</span><br><span style="color: #f5deb3;">pid</span><span style="color: #f5deb3;">=</span><span style="color: #f5deb3;">fork</span>();<br><span style="color: #b0c4de; font-weight: bold;">if</span> (<span style="color: #f5deb3;">pid</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #add8e6;">0</span>)<br><span style="color: #f5deb3;">printf</span>(<span style="color: #f5deb3;">“</span><span style="color: #f5deb3;">error</span> <span style="color: #f5deb3;">in</span> <span style="color: #f5deb3;">fork</span><span style="color: #f5deb3;">!</span><span style="color: #f5deb3;">”</span>);<br><span style="color: #b0c4de; font-weight: bold;">else</span> <span style="color: #b0c4de; font-weight: bold;">if</span> (<span style="color: #f5deb3;">pid</span> <span style="color: #f5deb3;">==</span> <span style="color: #add8e6;">0</span>)<br><span style="color: #f5deb3;">printf</span>(<span style="color: #f5deb3;">“</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">am</span> <span style="color: #f5deb3;">the</span> <span style="color: #f5deb3;">child</span> <span style="color: #f5deb3;">process</span><span style="color: #f5deb3;">,</span> <span style="color: #f5deb3;">my</span> <span style="color: #f5deb3;">process</span> <span style="color: #f5deb3;">id</span> <span style="color: #f5deb3;">is</span> <span style="color: #f5deb3;">%</span><span style="color: #f5deb3;">dn</span><span style="color: #f5deb3;">”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">getpid</span>());<br><span style="color: #b0c4de; font-weight: bold;">else</span><br><span style="color: #f5deb3;">printf</span>(<span style="color: #f5deb3;">“</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">am</span> <span style="color: #f5deb3;">the</span> <span style="color: #f5deb3;">parent</span> <span style="color: #f5deb3;">process</span><span style="color: #f5deb3;">,</span> <span style="color: #f5deb3;">my</span> <span style="color: #f5deb3;">process</span> <span style="color: #f5deb3;">id</span> <span style="color: #f5deb3;">is</span> <span style="color: #f5deb3;">%</span><span style="color: #f5deb3;">dn</span><span style="color: #f5deb3;">”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">getpid</span>());<br><span style="color: #f5deb3;">retrun</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span><br><span style="color: #eeee00;">#include <unistd.h>;</unistd.h></span><br><span style="color: #eeee00;">#include <sys types.h="">;</sys></span><br><span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #ffffff;">main</span> ()<br><span style="color: #f5deb3;">{</span><br><span style="color: #f5deb3;">pid_t</span> <span style="color: #f5deb3;">pid</span><br><span style="color: #f5deb3;">printf</span>(<span style="color: #f5deb3;">“</span><span style="color: #f5deb3;">fork</span><span style="color: #f5deb3;">\</span>n<span style="color: #f5deb3;">”</span>);<span style="color: #da70d6;">//注意这句和下面的区别</span><br><span style="color: #f5deb3;">pid</span><span style="color: #f5deb3;">=</span><span style="color: #f5deb3;">fork</span>();<br><span style="color: #b0c4de; font-weight: bold;">if</span> (<span style="color: #f5deb3;">pid</span> <span style="color: #f5deb3;">&lt;</span> <span style="color: #add8e6;">0</span>)<br><span style="color: #f5deb3;">printf</span>(<span style="color: #f5deb3;">“</span><span style="color: #f5deb3;">error</span> <span style="color: #f5deb3;">in</span> <span style="color: #f5deb3;">fork</span><span style="color: #f5deb3;">!</span><span style="color: #f5deb3;">”</span>);<br><span style="color: #b0c4de; font-weight: bold;">else</span> <span style="color: #b0c4de; font-weight: bold;">if</span> (<span style="color: #f5deb3;">pid</span> <span style="color: #f5deb3;">==</span> <span style="color: #add8e6;">0</span>)<br><span style="color: #f5deb3;">printf</span>(<span style="color: #f5deb3;">“</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">am</span> <span style="color: #f5deb3;">the</span> <span style="color: #f5deb3;">child</span> <span style="color: #f5deb3;">process</span><span style="color: #f5deb3;">,</span> <span style="color: #f5deb3;">my</span> <span style="color: #f5deb3;">process</span> <span style="color: #f5deb3;">id</span> <span style="color: #f5deb3;">is</span> <span style="color: #f5deb3;">%</span><span style="color: #f5deb3;">dn</span><span style="color: #f5deb3;">”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">getpid</span>());<br><span style="color: #b0c4de; font-weight: bold;">else</span><br><span style="color: #f5deb3;">printf</span>(<span style="color: #f5deb3;">“</span><span style="color: #f5deb3;">i</span> <span style="color: #f5deb3;">am</span> <span style="color: #f5deb3;">the</span> <span style="color: #f5deb3;">parent</span> <span style="color: #f5deb3;">process</span><span style="color: #f5deb3;">,</span> <span style="color: #f5deb3;">my</span> <span style="color: #f5deb3;">process</span> <span style="color: #f5deb3;">id</span> <span style="color: #f5deb3;">is</span> <span style="color: #f5deb3;">%</span><span style="color: #f5deb3;">dn</span><span style="color: #f5deb3;">”</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">getpid</span>());<br><span style="color: #b0c4de; font-weight: bold;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span></div><br>上面的两个会输出什么呢?</p>
<p>。</p>
<p>。</p>
<p>。</p>
<p>。</p>
<p>答案是</p>
<p>第一个输出:</p>
<p>forki am the child process, my process id is 2955</p>
<p>forki am the child process, my process id is 2954</p>
<p>第二个的输出是</p>
<p>fork</p>
<p>i am the child process, my process id is 2955</p>
<p>i am the child process, my process id is 2954</p>
<p>是不是觉得和我昨天说的不一样呢?怎么第一个中的fork输出两次呢？这里就和printf的缓冲有关了,具体的可以<a href="http://bbs.chinaunix.net/viewthread.php?tid=311067" target="_blank" rel="external"><span style="color: #ff0000;">参考这里</span></a></p>
<p>下面的是<a href="http://www.cppblog.com/zhangxu/archive/2007/12/02/37640.aspx" target="_blank" rel="external"><span style="color: #ff0000;">转自这里</span></a></p>
<p>我试验了下,结果和博主的相似.</p>
<p>.给你两分钟抢答时间</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>OK,答案来了.</p>
<p>对一下答案吧：[这分析和结果是复制过来的.]</p>
<p>[hardy@localhost fork]$ ./fork<br>father<br>son<br>son<br>son<br>father<br>father<br>son<br>father<br>son<br>son<br>father<br>father<br>son<br>father<br>总共7个son7个father。你答对了么？</p>
<p>这道题需要在纸上画画才好理解[由于格式会不对,所以我用图片,速度不给力的还请见谅]</p>
<p><a href="http://www.klion26.com/wp-content/uploads/2010/12/fork-1.bmp" target="_blank" rel="external"><img src="http://www.klion26.com/wp-content/uploads/2010/12/fork-1.bmp" alt="" title="fork-1"></a></p>
<p>其中每一行分别代表一个进程的运行打印结果。</p>
<p>当产生子进程的时刻，子进程打印son，当子进程调用fork的生成子子进程，他就提升为father。<br>总结来说，father永远打印father，son在fork之前是son，fork之后就为father，同时生成新的son。<br>这个比喻就像真正的父子，孩子长大了生了小孩，孩子就成了父亲。而父亲永远是父亲。</p>
<p>我自己试验的时候的结果如下:</p>
<p><a href="http://www.klion26.com/wp-content/uploads/2010/12/fork.bmp" target="_blank" rel="external"><img src="http://www.klion26.com/wp-content/uploads/2010/12/fork.bmp" alt="" title="fork"></a></p>

	
	</div>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2010-12-30 </div>
			<div class="article-title"><a href="/2010/12/30/linux-fork-test/" >fork函数小测试</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>本篇文章还是beta版,由于本人对这个函数的了解还不是非常清晰,暂时只知道返回值有两个,返回两次.一个是,表示创建的子进程,一个是创建的子进程的id.如果返回-1表示创建失败,下面就不考虑了.下面的函数是测试用代码.</p>
<p>代码如下:</p>
<p><div class="source" style="background-color: #2f4f4f; font-family: 'Courier New','Consolas','Lucida Console'; color: #f5deb3;"><span style="color: #eeee00;">#include <stdio.h></stdio.h></span><br><span style="color: #eeee00;">#include <unistd.h></unistd.h></span><br><span style="color: #eeee00;">#include <systypes.h></systypes.h></span></div><br><span style="color: #98fb98; font-weight: bold;">int</span> <span style="color: #ffffff;">main</span>(<span style="color: #98fb98; font-weight: bold;">void</span>)<br><span style="color: #f5deb3;">{</span><br>    <span style="color: #98fb98; font-weight: bold;">int</span> p;<br>    <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“main——</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span>);<br>    p <span style="color: #f5deb3;">=</span> <span style="color: #f5deb3;">fork</span>();<span style="color: #da70d6;">//调用fork函数</span><br>    <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“after-fork<strong><em>*</em></strong></span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span>);<br>    <span style="color: #b0c4de; font-weight: bold;">if</span>(<span style="color: #add8e6;">0</span> <span style="color: #f5deb3;">==</span> p)<br>       <span style="color: #f5deb3;">{</span><br>          <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“child  %d—–ppid-&gt;%d</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">getpid</span><span style="color: #f5deb3;">(),</span><span style="color: #f5deb3;">getppid</span>());<br>       <span style="color: #f5deb3;">}</span><br>    <span style="color: #b0c4de; font-weight: bold;">else</span><br>       <span style="color: #f5deb3;">{</span><br>          <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“parent %d—</span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span><span style="color: #f5deb3;">,</span><span style="color: #f5deb3;">getpid</span>());<br>       <span style="color: #f5deb3;">}</span><br>   <span style="color: #f5deb3;">printf</span>(<span style="color: #7fffd4;">“over—<em>*</em></span><span style="color: #7fffd4;">\n</span><span style="color: #7fffd4;">“</span>);<br>   <span style="color: #b0c4de; font-weight: bold;">return</span> <span style="color: #add8e6;">0</span><br><span style="color: #f5deb3;">}</span></p>
<p>结果如下:</p>
<p>main——</p>
<p>after-fork<strong><em>*</em></strong></p>
<p>child  2579—–ppid-&gt;2578</p>
<p>over—<em>*</em></p>
<p>after-fork<strong><em>*</em></strong></p>
<p>parent 2578—</p>
<p>over—<em>*</em></p>
<p>上述结果说明一些事情:首先是前面我说的.还有就是fork函数后面的都会被子进程和父进程都执行.还有一个是说这两个是并行的,也就是说可能先执行父进程再进行子进程,不过暂时结果没见过.等进一步了解之后,再来更新本篇文章.</p>

	
	</div>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2010-12-30 </div>
			<div class="article-title"><a href="/2010/12/30/wordpress-clickchar-plugin/" >wordpress之clickchar插件--不一样的提交按钮</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<pre><code>在[哑熊大牛](http://dumbear.com/blog/)的博客上看到这个插件,感觉很给力.于是就问了下,哑熊大牛一下就回复了.在此感谢下,哈哈.原来是个clickchar插件,话说这个插件不仅有提交按钮的作用,还有验证码的作用,而且样式也不错.于是就安装了,顺便在这推荐下。效果在本文的评论框下面
</code></pre><p>关于安装:wordpress 2.7以上版本可以直接在添加新插件那搜索clickchar就OK了,记得要设置API keys才可以用</p>

	
	</div>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2010-12-23 </div>
			<div class="article-title"><a href="/2010/12/23/linux-grub-encrypt/" >Linux Grub加密</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>上一篇文章中说到最好给grub也加密,由于我自己也没加密过,所以搜了下,方法如下 本人试验过可用<br>为grub密分为二种，一是明文，二是采用MD5算法的加密。<br>明文加密：编辑 grub.conf文件<br>vi /boot/grub/grub.conf 在default=0下面加一行 password=1234567890(这个就是明文密码)</p>
<p>MD5加密：先要命令 grub-md5-crypt计算出MD5的值，然后复制这个值到grub.conf文件中 password –md5$BYxEn$e5X/xOTS2pTpPPWtgIMhU1(这个就是用MD5加密后的值)<br>转载自：<a href="http://blog.csdn.net/magicbreaker/archive/2008/11/23/3357209.aspx" target="_blank" rel="external">http://blog.csdn.net/magicbreaker/archive/2008/11/23/3357209.aspx
</a>另外可以参照:<a href="http://linux.chinaitlab.com/safe/798285.html" target="_blank" rel="external">http://linux.chinaitlab.com/safe/798285.html</a>[说的比较好]</p>

	
	</div>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2010-12-23 </div>
			<div class="article-title"><a href="/2010/12/23/linux-single-user-config/" >Linux下单用户模式修改错误配置文件</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>晚上同学发过来一条消息说他的Linux出问题了,让我看看,如图</p>
<p><a href="http://www.klion26.com/wp-content/uploads/2010/12/未命名.jpg" target="_blank" rel="external"><img src="http://www.klion26.com/wp-content/uploads/2010/12/未命名.jpg" alt="" title="未命名"></a>root前面多了个sarwar<br>一开始我以为他他改的PS1,让他推出用root登录下再改PS1,可是他说他的密码错误了,这个就尴尬了,然后问他进行了什么操作,他说改了/etc/passwd这个文件.这就是问题所在了。到这里一般有两种方法解决,一是重装,因为是装载虚拟机里面,重装也不是什么很大的事,不过Red Hat9装起来还是比较麻烦的。二是通过单用户来修改错误配置,下面就讲下怎么通过单用户来修改错误配置首先来到grub项的时候如下图</p>
<p><a href="http://www.klion26.com/wp-content/uploads/2010/12/grub1.jpg" target="_blank" rel="external"><img src="http://www.klion26.com/wp-content/uploads/2010/12/grub1-300x285.jpg" alt="" title="grub1"></a></p>
<p>这时按下e然后出现下面的界面</p>
<p><a href="http://www.klion26.com/wp-content/uploads/2010/12/grub2.jpg" target="_blank" rel="external"><img src="http://www.klion26.com/wp-content/uploads/2010/12/grub2-300x284.jpg" alt="" title="grub2"></a></p>
<p>这时选中第二项再按下e会出现如下界面</p>
<p><a href="http://www.klion26.com/wp-content/uploads/2010/12/grub3.jpg" target="_blank" rel="external"><img src="http://www.klion26.com/wp-content/uploads/2010/12/grub3-300x284.jpg" alt="" title="grub3"></a></p>
<p>在这里输入空格加1[空格是必需的,1代表单用户模式]然后回车出现如下界面</p>
<p><a href="http://www.klion26.com/wp-content/uploads/2010/12/grub4.jpg" target="_blank" rel="external"><img src="http://www.klion26.com/wp-content/uploads/2010/12/grub4-300x283.jpg" alt="" title="grub4"></a></p>
<p>这时再按下b然后系统就会重启,重启后就是以单用户模式启动了.于是你就可以在这里修改错误的配置文件了.所以一般来说不需要知道别人的密码也可以进入他的Linux系统,因为用如上方式可以修改密码,而且不需要知道原来的密码.所以一般最好给grub也加上密码.这样就可以了</p>

	
	</div>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2010-12-22 </div>
			<div class="article-title"><a href="/2010/12/22/linux-shell-problem/" >Linux Shell遇到的问题</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>今天上实验课,遇到了一些Shell的问题,有些是帮同学解决问题时遇到的,有时是自己遇到的,也让我对某些命令有了个更好的了解.写此文章纯属备份.</p>
<p> 挂载U盘的方法.</p>
<p>1)插入U盘,fdisk -l得到U盘对应的分区.</p>
<p>2)新建一个文件夹,一般建在/mnt下,名字一般加usb.[mkdir usb]</p>
<p>3)挂载.mount  <span style="color: #ff0000;">/dev/sdb1  <span style="color: #000000;">/mnt/usb[红色的地方是你机器上查出来的分区]</span></span></p>
<p><span style="color: #ff0000;"><span style="color: #000000;">卸载就直接用umount /dev/sdb1或者umount /mnt/usb</span></span></p>
<p><span style="color: #ff0000;"><span style="color: #000000;">还有就是shell里面的x=x+1的写法,一开始由于这个导致我的程序各种无语,要不就是死循环,要不就是找不到命令.后来一个命令一个命令的分开试,然后再组起来.才发现是这句话的错误,原因是我的’+’两边没加空格.这还是自己写的少的原因.x=x+1有两种写法, x=$(($x + 1))和x=<code>expr $x + 1</code>[是反引号]</span></span></p>

	
	</div>
</div>

           
		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">
<ul class="pagination">
	 
		
    	<li class="prev"><a href="/page/16/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i> 上一页</a></li>
  		

        <li><a href="/"><i class="fa fa-home"></i>Home</a></li>

		
		   <li class="next"> <a href="/page/18/" class="alignright next">下一页<i class="fa fa-arrow-circle-o-right"></i></a> </li>          
        
	
</ul>
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="搜索" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
	<div class="widget">
		<h4>分类</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/ACM/">ACM<span>16</span></a></li>
		
			<li><a href="/categories/Algorithm/">Algorithm<span>14</span></a></li>
		
			<li><a href="/categories/HDU/">HDU<span>9</span></a></li>
		
			<li><a href="/categories/ACM/HDU/">HDU<span>1</span></a></li>
		
			<li><a href="/categories/Linux/">Linux<span>32</span></a></li>
		
			<li><a href="/categories/POJ/">POJ<span>6</span></a></li>
		
			<li><a href="/categories/Linux/TeX/">TeX<span>1</span></a></li>
		
			<li><a href="/categories/USACO/">USACO<span>21</span></a></li>
		
			<li><a href="/categories/Uncategorized/">Uncategorized<span>3</span></a></li>
		
			<li><a href="/categories/Visual-C/">Visual C++<span>1</span></a></li>
		
			<li><a href="/categories/实时计算/复盘/problem-solve/">problem_solve<span>1</span></a></li>
		
			<li><a href="/categories/wordpress/">wordpress<span>8</span></a></li>
		
			<li><a href="/categories/具体数学/">具体数学<span>2</span></a></li>
		
			<li><a href="/categories/分布式系统/">分布式系统<span>9</span></a></li>
		
			<li><a href="/categories/实时计算/复盘/">复盘<span>1</span></a></li>
		
			<li><a href="/categories/实时计算/">实时计算<span>7</span></a></li>
		
			<li><a href="/categories/分布式系统/实时计算/">实时计算<span>5</span></a></li>
		
			<li><a href="/categories/我的生活/想清楚/">想清楚<span>1</span></a></li>
		
			<li><a href="/categories/想清楚/">想清楚<span>1</span></a></li>
		
			<li><a href="/categories/成长/">成长<span>3</span></a></li>
		
			<li><a href="/categories/我的生活/">我的生活<span>9</span></a></li>
		
			<li><a href="/categories/所谓开源/">所谓开源<span>3</span></a></li>
		
			<li><a href="/categories/数学/">数学<span>2</span></a></li>
		
			<li><a href="/categories/POJ/数学/">数学<span>2</span></a></li>
		
			<li><a href="/categories/Algorithm/数学/">数学<span>1</span></a></li>
		
			<li><a href="/categories/分布式系统/实时计算/源码阅读/">源码阅读<span>1</span></a></li>
		
			<li><a href="/categories/源码阅读/">源码阅读<span>1</span></a></li>
		
			<li><a href="/categories/计算机图形学图像处理/">计算机图形学图像处理<span>1</span></a></li>
		
			<li><a href="/categories/Linux/计算机图形学图像处理/">计算机图形学图像处理<span>1</span></a></li>
		
			<li><a href="/categories/计算机基础/">计算机基础<span>22</span></a></li>
		
			<li><a href="/categories/Linux/计算机基础/">计算机基础<span>2</span></a></li>
		
			<li><a href="/categories/Algorithm/计算机基础/">计算机基础<span>1</span></a></li>
		
			<li><a href="/categories/语言学习/计算机基础/">计算机基础<span>1</span></a></li>
		
			<li><a href="/categories/所谓开源/计算机基础/">计算机基础<span>1</span></a></li>
		
			<li><a href="/categories/计算机安全/">计算机安全<span>3</span></a></li>
		
			<li><a href="/categories/计算机基础/语言学习/">语言学习<span>1</span></a></li>
		
			<li><a href="/categories/语言学习/">语言学习<span>2</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>标签云</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/i-o-multiplexing/">i/o multiplexing<span>1</span></a></li>
		
			<li><a href="/tags/metric-core/">metric-core<span>1</span></a></li>
		
			<li><a href="/tags/objdump/">objdump<span>1</span></a></li>
		
			<li><a href="/tags/at-least-once/">at-least-once<span>3</span></a></li>
		
			<li><a href="/tags/reliability/">reliability<span>1</span></a></li>
		
			<li><a href="/tags/english/">english<span>1</span></a></li>
		
			<li><a href="/tags/top排序/">top排序<span>2</span></a></li>
		
			<li><a href="/tags/huawei/">huawei<span>1</span></a></li>
		
			<li><a href="/tags/distributed-system/">distributed-system<span>2</span></a></li>
		
			<li><a href="/tags/exactly-once/">exactly-once<span>3</span></a></li>
		
			<li><a href="/tags/6-824/">6.824<span>2</span></a></li>
		
			<li><a href="/tags/real-time-computing/">real_time-computing<span>2</span></a></li>
		
			<li><a href="/tags/rpm/">rpm<span>1</span></a></li>
		
			<li><a href="/tags/code/">code<span>2</span></a></li>
		
			<li><a href="/tags/level-order/">level-order<span>1</span></a></li>
		
			<li><a href="/tags/learn-algorithm-from-scratch/">learn algorithm from scratch<span>3</span></a></li>
		
			<li><a href="/tags/offset/">offset<span>1</span></a></li>
		
			<li><a href="/tags/protobuf/">protobuf<span>1</span></a></li>
		
			<li><a href="/tags/最坏情况/">最坏情况<span>1</span></a></li>
		
			<li><a href="/tags/单用户模式/">单用户模式<span>1</span></a></li>
		
		
		   <li><a href="/tags">...<span>270</span></a></li>
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>最新文章</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2017/06/03/Streaming-程序调用-Producer-close-hang-住问题追查复盘/" ><i class="fa fa-file-o"></i>Streaming 程序调用 Producer.clo...</a>
      </li>
    
      <li>
        <a href="/2017/06/01/如何在不重启-Spark-Streaming-作业的情况下，增加消费的-topic/" ><i class="fa fa-file-o"></i>如何在不重启 Spark Streaming 作业的情...</a>
      </li>
    
      <li>
        <a href="/2017/05/29/从源码级别分析-metric-core-的抽样算法/" ><i class="fa fa-file-o"></i>从源码级别分析 metric-core 的抽样算法</a>
      </li>
    
      <li>
        <a href="/2017/05/19/Streaming-中-Receiver-相关源码分析/" ><i class="fa fa-file-o"></i>Streaming 中 Receiver 相关源码分析</a>
      </li>
    
      <li>
        <a href="/2017/05/10/Python-代码实践小结/" ><i class="fa fa-file-o"></i>Python 代码实践小结</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>链接</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="http://www.github.com/klion26" title="My Github account." target="_blank"]);">My Github</a></li>
	
		<li><i class=""></i><a href="http://l34rner.github.io/" title="A blog focus on security!" target="_blank"]);">Debug0</a></li>
	
		<li><i class=""></i><a href="http://www.programlife.net/" title="程序人生" target="_blank"]);">代码疯子</a></li>
	
		<li><i class=""></i><a href="http://www.narutoacm.com/" title="NARUTOACM" target="_blank"]);">NARUTOACM</a></li>
	
		<li><i class=""></i><a href="http://www.tanglei.name/" title="tanglei 的 blog" target="_blank"]);">tanglei的blog</a></li>
	
		<li><i class=""></i><a href="http://www.microspaze.com/" title="微空间" target="_blank"]);">微空间</a></li>
	
		<li><i class=""></i><a href="http://www.toutian.org/" title="小昭的荒地" target="_blank"]);">小昭的荒地</a></li>
	
		<li><i class=""></i><a href="https://cosx.me/" title="异想天开" target="_blank"]);">异想天开</a></li>
	
		<li><i class=""></i><a href="http://www.xpc-yx.com/" title="远行" target="_blank"]);">远行</a></li>
	
		<li><i class=""></i><a href="http://www.zhangxc.com/" title="张学程" target="_blank"]);">张学程</a></li>
	
	</ul>
</div>


		
			<!-- calendar widget -->

  <script src="/js/calendar.js"></script>
  <script src="/js/languages.js"></script>
  <script type="text/javascript">
    $(function() {
    
      $('#calendar').aCalendar('zh-CN',{single:undefined, root:'undefined'});
    
    });
  </script>


<div class="widget-wrap">
  <h3 class="widget-title">日历云</h3>
  <div class="widget">
    <div id="calendar"></div>
  </div>
</div
		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->


	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2017 klion26
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
